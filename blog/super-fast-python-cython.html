<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Maven+Pro&amp;family=Share+Tech+Mono&amp;family=Source+Sans+Pro&amp;family=Ubuntu&amp;display=swap" data-optimized-fonts="true"/><meta charSet="utf-8" class="jsx-1274090743"/><meta name="viewport" content="width=device-width, initial-scale=1" class="jsx-1274090743"/><meta name="description" content="Convert slow Python code to run as fast as C/C++ using Cython." class="jsx-1274090743"/><meta name="author" content="Santha Lakshmi Narayana" class="jsx-1274090743"/><meta name="keywords" content="cython,python-performance&#x27;,python-optimize,python,fast-python,speed,python" class="jsx-1274090743"/><meta property="og:title" content="Super fast Python (Part-4): Cython- Santha Lakshmi Narayana" class="jsx-1274090743"/><meta property="og:description" content="Convert slow Python code to run as fast as C/C++ using Cython." class="jsx-1274090743"/><meta property="og:url" content="https://santhalakshminarayana.github.io/blog/super-fast-python-cython" class="jsx-1274090743"/><meta property="og:image" content="https://santhalakshminarayana.github.io/images/super-fast-python-cython/super-fast-python-cython.jpg" class="jsx-1274090743"/><meta property="og:type" content="article" class="jsx-1274090743"/><meta property="og:article:publisher" content="https://santhalakshminarayana.github.io/" class="jsx-1274090743"/><meta property="og:site_name" content="Santha Lakshmi Narayana" class="jsx-1274090743"/><meta name="twitter:card" content="summary_large_image" class="jsx-1274090743"/><meta name="twitter:title" content="Super fast Python (Part-4): Cython- Santha Lakshmi Narayana" class="jsx-1274090743"/><meta name="twitter:description" content="Convert slow Python code to run as fast as C/C++ using Cython." class="jsx-1274090743"/><meta name="twitter:url" content="https://santhalakshminarayana.github.io/blog/super-fast-python-cython" class="jsx-1274090743"/><meta name="twitter:site" content="@santhalakshminarayana" class="jsx-1274090743"/><meta name="twitter:image" content="https://santhalakshminarayana.github.io/images/super-fast-python-cython/super-fast-python-cython.jpg" class="jsx-1274090743"/><meta name="twitter:creator" content="@santhalakshminarayana" class="jsx-1274090743"/><link rel="icon" href="/images/santha-lakshmi-narayana-logo.png?" class="jsx-1274090743"/><link rel="canonical" href="https://santhalakshminarayana.github.io/blog/super-fast-python-cython" class="jsx-1274090743"/><title class="jsx-1274090743">Super fast Python (Part-4): Cython- Santha Lakshmi Narayana</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous" class="jsx-1274090743"/><meta name="next-head-count" content="24"/><link rel="preload" href="/_next/static/css/b1be9be44572118d40d2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b1be9be44572118d40d2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-2b6f4fb4c650415a78b4.js" defer=""></script><script src="/_next/static/chunks/framework.1b3b121feae4c8ce410b.js" defer=""></script><script src="/_next/static/chunks/commons.5b2d72a8e34e4f7cda46.js" defer=""></script><script src="/_next/static/chunks/main-d372fe187139d1f38e70.js" defer=""></script><script src="/_next/static/chunks/pages/_app-90550e3da438f273bbf6.js" defer=""></script><script src="/_next/static/chunks/d0447323.c092ac6ab57aede80368.js" defer=""></script><script src="/_next/static/chunks/773f402080c38a523cb0b4f52dac49b5097e45fc.c30f0cfea8498bde8fa9.js" defer=""></script><script src="/_next/static/chunks/6188d020c9511bd1e7ae4c1c2034aa4e99a1704e.fe25fa9d88e935be6ae1.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bid%5D-d3a90f1f73d9eb2bb713.js" defer=""></script><script src="/_next/static/jBc4UZUL4xIRAkt3gOT-Q/_buildManifest.js" defer=""></script><script src="/_next/static/jBc4UZUL4xIRAkt3gOT-Q/_ssgManifest.js" defer=""></script><style id="__jsx-1906274153">.tags.jsx-1906274153{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:1vw 5vw 1vw 5vw;background-color:#fffecb;border-bottom:5px solid #071013;}.tags.jsx-1906274153 a.jsx-1906274153{font-family:'Share Tech Mono',monospace;color:#1d2b35;margin:0 1em 0 1em;-webkit-text-decoration:none;text-decoration:none;border-bottom:1px dashed #fb232e;}.tags.jsx-1906274153 a.jsx-1906274153:hover{background:#20a4f3;color:#fffecb;border-bottom:1px dashed #fffecb;}.tags.jsx-1906274153 a.jsx-1906274153:active{background:#fb232e;}</style><style id="__jsx-286259859">.header-container.jsx-286259859{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding:10px 5vw 10px 5vw;background:#1d2b35;}.header-left.jsx-286259859{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.header-left.jsx-286259859 a.jsx-286259859{font-family:'Source Sans Pro',sans-serif;-webkit-text-decoration:none;text-decoration:none;color:#ffaa33;}img.jsx-286259859{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;width:calc(1.2rem + 1vw);max-width:calc(1.2rem + 1vw);height:auto;margin:0 5px 0 5px;}img.jsx-286259859:hover{cursor:pointer;}.header-left.jsx-286259859 a.jsx-286259859:hover{color:#20a4f3;}.header-left.jsx-286259859 a.jsx-286259859:active{color:#fb232e;}.header-right.jsx-286259859{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:3;-ms-flex:3;flex:3;-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.header-right.jsx-286259859 a.jsx-286259859{padding:0 1vw 0 1vw;font-family:'Source Sans Pro',sans-serif;-webkit-text-decoration:none;text-decoration:none;color:#ffaa33;}.header-right.jsx-286259859 a.jsx-286259859:hover{color:#20a4f3;}.header-right.jsx-286259859 a.jsx-286259859:active{color:#fb232e;}@media screen and (max-width:920px){.header-container.jsx-286259859{padding:10px 2vw 10px 2vw;overflow-x:scroll;}#name.jsx-286259859{display:none;}img.jsx-286259859{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}@media screen and (max-width:480px){.header-container.jsx-286259859{padding:10px 2vw 10px 2vw;overflow-x:scroll;}}@media screen and (max-width:300px){img.jsx-286259859{display:none;}}</style><style id="__jsx-4051774662">.img-text.jsx-4051774662{display:block;text-align:center;font-family:'Source Sans Pro',sans-serif;font-size:calc(0.8rem + 0.1vw);color:#1d2b35;overflow-wrap:'break-word',;}a.jsx-4051774662{margin:0;-webkit-text-decoration:none;text-decoration:none;color:#1d2b35;border-bottom:1px solid;}</style><style id="__jsx-2122502216">.file-name-container.jsx-2122502216{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;max-width:100%;background-color:#1d2b35d9;padding:calc(0.5rem + 0.2vw);border-top-left-radius:5px;border-top-right-radius:5px;margin-top:1vh;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:break-word;}.file-name.jsx-2122502216{font-family:'Share Tech Mono',monospace;font-size:calc(0.9rem + 0.1vw);color:#fffecbf2;}</style><style id="__jsx-1393389675">.footer-container.jsx-1393389675{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background:#1d2b35e6;padding:1vw 1vw 1vw 1vw;}.footer-container-links.jsx-1393389675{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.footer-links.jsx-1393389675{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.link-item.jsx-1393389675{margin:0 1vw 0 1vw;}.link.jsx-1393389675{-webkit-text-decoration:none;text-decoration:none;cursor:pointer: background-color:yellow;}.link.jsx-1393389675:hover{color:black;}.copy-right-container.jsx-1393389675{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-top:10px;}.copy-right-text.jsx-1393389675{font-family:'Maven Pro',sans-serif;font-size:calc(0.75rem + 0.1vw);color:#fffecb;}</style><style id="__jsx-1274090743">.blog-content.jsx-1274090743{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:100%;-ms-flex:100%;flex:100%;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:1vw 25vw 1vw 25vw;width:50vw;max-width:50vw;min-height:90vh;}@media screen and (max-width:980px){.blog-content.jsx-1274090743{margin:1vw 15vw 1vw 15vw;width:70vw;max-width:70vw;}}@media screen and (max-width:760px){.blog-content.jsx-1274090743{margin:1vw 5vw 1vw 5vw;width:90vw;max-width:90vw;}}</style><style data-href="https://fonts.googleapis.com/css2?family=Maven+Pro&family=Share+Tech+Mono&family=Source+Sans+Pro&family=Ubuntu&display=swap">@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v32/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX25nM.woff) format('woff')}@font-face{font-family:'Share Tech Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sharetechmono/v15/J7aHnp1uDWRBEqV98dVQztYldFc7pw.woff) format('woff')}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3aPA.woff) format('woff')}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgo6ew.woff) format('woff')}@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v32/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX21nijpBh8CvRBOB1s.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v32/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX21nmjpBh8CvRBOB1s.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v32/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX21nejpBh8CvRBOA.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Share Tech Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sharetechmono/v15/J7aHnp1uDWRBEqV98dVQztYldFcLowEFA87Heg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNa7lujVj9_mf.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3qPK7lujVj9_mf.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNK7lujVj9_mf.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3qO67lujVj9_mf.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3qN67lujVj9_mf.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNq7lujVj9_mf.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v21/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgoKcg72nU6AF7xm.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgoKew72nU6AF7xm.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgoKcw72nU6AF7xm.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgoKfA72nU6AF7xm.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgoKcQ72nU6AF7xm.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgoKfw72nU6AFw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div style="min-height:100vh" class="jsx-1274090743"><div class="jsx-286259859 header"><div class="jsx-286259859 header-container"><div class="jsx-286259859 header-left"><img src="/images/santha-lakshmi-narayana-logo.png" alt="Logo" class="jsx-286259859"/><a id="name" class="jsx-286259859" href="/"><b class="jsx-286259859">Santha Lakshmi Narayana</b></a></div><div class="jsx-286259859 header-right"><a class="jsx-286259859" href="/about">About</a><a href="#" class="jsx-286259859">Tags</a><a class="jsx-286259859" href="/">Home</a></div></div><div style="display:none" class="jsx-286259859"><div class="jsx-1906274153 tags"><a class="jsx-1906274153" href="/tags/image-processing">#image-processing</a><a class="jsx-1906274153" href="/tags/opencv">#opencv</a><a class="jsx-1906274153" href="/tags/python-performance">#python-performance</a><a class="jsx-1906274153" href="/tags/color-science">#color-science</a><a class="jsx-1906274153" href="/tags/react">#react</a><a class="jsx-1906274153" href="/tags/next-js">#next-js</a><a class="jsx-1906274153" href="/tags/flutter">#flutter</a></div></div></div><article class="jsx-1274090743 blog-content"><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><picture class="jsx-4051774662"><img src="/images/super-fast-python-cython/super-fast-python-cython.jpg" alt="Super fast Python" style="width:100%;max-width:100%;height:auto;margin-left:0%" class="jsx-4051774662"/><span class="jsx-4051774662 img-text"></span></picture></p><h1 style="font-family:&#x27;Ubuntu&#x27;, sans-serif;font-size:calc(1rem + 1.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Super fast Python (Part-4): Cython</h1><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">This is the fourth post in the series on Python performance and Optimization. The series points out the utilization of inbuilt libraries, low-level code conversions, and other Python implementations to speed-up Python. The other posts included in this series are </p><ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word"><li>(Part-1): <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://santhalakshminarayana.github.io/blog/super-fast-python-why-python-slow">Why Python is slow?</a></li><li>(Part-2): <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://santhalakshminarayana.github.io/blog/super-fast-python-good-practices">Good practices to write fast Python code</a></li><li>(Part-3): <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://santhalakshminarayana.github.io/blog/super-fast-python-multi-processing">Multi-processing in Python</a></li><li>(Part-4): Use Cython to get speed as fast as C (this post)</li><li>(Part-5): Use Numba to speed up Python Functions and Classes</li></ul><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">In the last post, we discussed <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">multiprocessing</strong> to optimize Python code by utilizing parallel computing with multiple CPU cores. Multi-processing is useful when we can split certain parts of code into parallel tasks and then execute them parallelly. </p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Imagine when we don&#x27;t have any parallelizable code and it is taking huge time in Python compared to <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">C/C++</strong>, how to optimize the code then? One thing we can do is to convert the Python code into a low-level programming language like C/C++ and <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://docs.python.org/3/extending/extending.html">embed that C/C++ code in Python</a>. Understanding and writing C/C++ code is hard for someone who is not familiar with C/C++. Fortunately, we can get the performance speed as fast as C/C++ by writing the Python code in <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.org/">Cython</a> which is a superset of Python that provides functionality to write C-Extensions for Python.</p><h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">How Cython can improve Speed?</h2><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">In our previous discussion on <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://santhalakshminarayana.github.io/blog/super-fast-python-why-python-slow">Why Python is slow?</a>, we learned that the major speed issues arise in Python due to</p><ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word"><li>interpretation of generated bytecode</li><li>dynamic types and their management</li></ul><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">With Cython, we can take care of the above problems with both compiled code instead of interpretation and static typing instead of dynamic typing. </p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Cython translates the Python code into C extension code and compiles the C code into an object code that can be imported directly into Python. Also, we can make some changes like adding static types that improve the execution speed drastically over dynamic typing. Cython also supports the usage of C/C++ libraries and functions that are super-fast compared to Python libraries and functions.</p><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Install Cython</h3><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/quickstart/install.html">Install the Cython</a> with Pip as follows</p><pre><pre class="language-bash" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-bash" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:#dcdcaa">install</span><span> Cython
</span></code></pre></pre><blockquote style="font-style:italic;background-color:#20a4f326;padding:10px;margin:1vh 0 1vh 0;border-left:5px solid #20a4f3e6"><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">To compile the C code into an object file, we need a C compiler. Ubuntu comes with <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">gcc</strong> by default. For other platforms like Windows, install the C compiler if not installed previously.</p></blockquote><hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/><h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Cython usage</h2><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">There are multiple ways to use Cython like building manually,  using in Jupyter as an extension, or importing directly like a Python module without compilation using <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">pyximport</em>.</p><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Build a Cython module manually</h3><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">We write the Cython code in a file with the extension <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">.pyx</em> instead of the normal Python extension <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">.py</em>.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The compiler translates &#x27;.pyx&#x27; Cython file into a &#x27;.c&#x27; C file and then compiles that C file to a sharable object file &#x27;.so&#x27; (or &#x27;.pyd&#x27; on Windows). We tell the compiler those build instructions and compilation options by writing a <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#basic-setup-py">setup.py</a> file.</p><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Cython compilation</h3><ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word"><li>Translate the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">.pyx</em> source code to a <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">.c</em> file with additional wrappers of Python extension code.</li><li>Compile the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">.c</em> file with a C compiler to a platform-specific shared object file <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">.so</em> that can be imported directly into Python.</li></ul><pre><div class="jsx-2122502216"><div class="jsx-2122502216 file-name-container"><p class="jsx-2122502216 file-name">calculate_y_cython.pyx</p></div><pre class="language-python:calculate_y_cython.pyx" style="color:#1d2b35;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0px;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-bottom:1vh;border-bottom-left-radius:5px;border-bottom-right-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">def</span><span> </span><span class="token" style="color:#dcdcaa">fx</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    d </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>a </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> c
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> a</span><span class="token" style="color:#d4d4d4">*</span><span>x </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> c</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> d
</span>
<span></span><span class="token" style="color:#569CD6">def</span><span> </span><span class="token" style="color:#dcdcaa">y</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> n</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    af </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span>
</span><span>    k </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">abs</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">//</span><span class="token" style="color:#b5cea8">2</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span> x</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    bf </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>k</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>af</span><span class="token" style="color:#d4d4d4">-</span><span>bf</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">/</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">1e-12</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">def</span><span> </span><span class="token" style="color:#dcdcaa">calculate_y_cython</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    ys </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#d4d4d4">]</span><span>
</span><span>    a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">5</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">4</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">for</span><span> i </span><span class="token" style="color:#569CD6">in</span><span> </span><span class="token" style="color:#ce9178">range</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        ys</span><span class="token" style="color:#d4d4d4">.</span><span>append</span><span class="token" style="color:#d4d4d4">(</span><span>y</span><span class="token" style="color:#d4d4d4">(</span><span>i</span><span class="token" style="color:#d4d4d4">,</span><span> n</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>    
<span>    </span><span class="token" style="color:#569CD6">return</span><span> ys
</span></code></pre></div></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The above file <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">calculate_y.pyx</em> contains Cython code that looks the same as Python without any optimizations. Now to compile the above file, write a <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">setup.py</em> file as following</p><pre><div class="jsx-2122502216"><div class="jsx-2122502216 file-name-container"><p class="jsx-2122502216 file-name">setup.py</p></div><pre class="language-python:setup.py" style="color:#1d2b35;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0px;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-bottom:1vh;border-bottom-left-radius:5px;border-bottom-right-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">from</span><span> distutils</span><span class="token" style="color:#d4d4d4">.</span><span>core </span><span class="token" style="color:#569CD6">import</span><span> setup
</span><span></span><span class="token" style="color:#569CD6">from</span><span> Cython</span><span class="token" style="color:#d4d4d4">.</span><span>Build </span><span class="token" style="color:#569CD6">import</span><span> cythonize
</span>
<span>setup</span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>    name</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#ce9178">&#x27;Calculate Expression Y&#x27;</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    ext_modules</span><span class="token" style="color:#d4d4d4">=</span><span>cythonize</span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>        </span><span class="token" style="color:#ce9178">&quot;calculate_y_cython.pyx&quot;</span><span class="token" style="color:#d4d4d4">,</span><span> 
</span><span>        compiler_directives</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#d4d4d4">{</span><span class="token" style="color:#ce9178">&quot;language_level&quot;</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">&quot;3&quot;</span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">)</span><span>
</span></code></pre></div></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">In the above <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">setup.py</em>, for the <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">setup()</strong>, we have passed the optional name to our Cython module for <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">name</em> and the path to the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">.pyx</em> file for the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">ext_module</em> parameter.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Build the sharable object file &#x27;.so&#x27; using the following command in the terminal</p><pre><pre class="language-bash" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-bash" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python setup.py build_ext --inplace
</span>or
<!-- -->python setup.py build_ext --inplace --quiet
</code></pre></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">This will generate a translated &#x27;.c&#x27; C file and a compiled &#x27;.so&#x27; file.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">We can import the above compiled <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">calculate_y_cython</em> module directly into Python runtime.</p><pre><div class="jsx-2122502216"><div class="jsx-2122502216 file-name-container"><p class="jsx-2122502216 file-name">main.py</p></div><pre class="language-python:main.py" style="color:#1d2b35;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0px;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-bottom:1vh;border-bottom-left-radius:5px;border-bottom-right-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">from</span><span> time </span><span class="token" style="color:#569CD6">import</span><span> perf_counter
</span><span></span><span class="token" style="color:#569CD6">from</span><span> calculate_y_cython </span><span class="token" style="color:#569CD6">import</span><span> calculate_y_cython
</span>
<span></span><span class="token" style="color:#569CD6">def</span><span> </span><span class="token" style="color:#dcdcaa">fx</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    d </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>a </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> c
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> a</span><span class="token" style="color:#d4d4d4">*</span><span>x </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> c</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> d
</span>
<span></span><span class="token" style="color:#569CD6">def</span><span> </span><span class="token" style="color:#dcdcaa">y</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> n</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    af </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span>
</span><span>    k </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">abs</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">//</span><span class="token" style="color:#b5cea8">2</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span> x</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    bf </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>k</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>af</span><span class="token" style="color:#d4d4d4">-</span><span>bf</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">/</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">1e-12</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">def</span><span> </span><span class="token" style="color:#dcdcaa">calculate_y_py</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    ys </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#d4d4d4">]</span><span>
</span><span>    a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">5</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">4</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">for</span><span> i </span><span class="token" style="color:#569CD6">in</span><span> </span><span class="token" style="color:#ce9178">range</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        ys</span><span class="token" style="color:#d4d4d4">.</span><span>append</span><span class="token" style="color:#d4d4d4">(</span><span>y</span><span class="token" style="color:#d4d4d4">(</span><span>i</span><span class="token" style="color:#d4d4d4">,</span><span> n</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>    
<span>    </span><span class="token" style="color:#569CD6">return</span><span> ys
</span>
<span></span><span class="token" style="color:#569CD6">def</span><span> </span><span class="token" style="color:#dcdcaa">main</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    n </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">100000</span><span>
</span><span>    </span><span class="token" style="color:#6a9955"># Python implementation</span><span>
</span><span>    atime </span><span class="token" style="color:#d4d4d4">=</span><span> perf_counter</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    res </span><span class="token" style="color:#d4d4d4">=</span><span> calculate_y_py</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">print</span><span class="token" style="color:#d4d4d4">(</span><span class="token string-interpolation" style="color:#ce9178">f&#x27;Python Time: </span><span class="token string-interpolation" style="color:#d4d4d4">{</span><span class="token string-interpolation" style="color:#9cdcfe">perf_counter</span><span class="token string-interpolation" style="color:#d4d4d4">(</span><span class="token string-interpolation" style="color:#d4d4d4">)</span><span class="token string-interpolation" style="color:#d4d4d4">-</span><span class="token string-interpolation" style="color:#9cdcfe">atime</span><span class="token string-interpolation" style="color:#d4d4d4">:</span><span class="token string-interpolation format-spec" style="color:#9cdcfe">.2</span><span class="token string-interpolation" style="color:#d4d4d4">}</span><span class="token string-interpolation" style="color:#ce9178">&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>    
<span>    atime </span><span class="token" style="color:#d4d4d4">=</span><span> perf_counter</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    res </span><span class="token" style="color:#d4d4d4">=</span><span> calculate_y_cython</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">print</span><span class="token" style="color:#d4d4d4">(</span><span class="token string-interpolation" style="color:#ce9178">f&#x27;Cython Time: </span><span class="token string-interpolation" style="color:#d4d4d4">{</span><span class="token string-interpolation" style="color:#9cdcfe">perf_counter</span><span class="token string-interpolation" style="color:#d4d4d4">(</span><span class="token string-interpolation" style="color:#d4d4d4">)</span><span class="token string-interpolation" style="color:#d4d4d4">-</span><span class="token string-interpolation" style="color:#9cdcfe">atime</span><span class="token string-interpolation" style="color:#d4d4d4">:</span><span class="token string-interpolation format-spec" style="color:#9cdcfe">.2</span><span class="token string-interpolation" style="color:#d4d4d4">}</span><span class="token string-interpolation" style="color:#ce9178">&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>    
<span></span><span class="token" style="color:#569CD6">if</span><span> __name__</span><span class="token" style="color:#d4d4d4">==</span><span class="token" style="color:#ce9178">&quot;__main__&quot;</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    main</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token triple-quoted-string" style="color:#ce9178">&quot;&quot;&quot;Output:
</span><span class="token triple-quoted-string" style="color:#ce9178">Python Time: 0.19
</span><span class="token triple-quoted-string" style="color:#ce9178">Cython Time: 0.16
</span><span class="token triple-quoted-string" style="color:#ce9178">&quot;&quot;&quot;</span><span>
</span></code></pre></div></pre><blockquote style="font-style:italic;background-color:#20a4f326;padding:10px;margin:1vh 0 1vh 0;border-left:5px solid #20a4f3e6"><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">At the time of writing, the latest Python version is Python 3.11 which is incredibly faster (30-60% in some cases) than earlier versions. So, to understand the Cython potential, I&#x27;m running the scripts in Python 3.8.10 on my old system with 8GB Intel(R) i5-8250U 1.60GHz CPU on HP Laptop 15-da0xxx.</p></blockquote><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">In the above <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">main.py</em>, we have imported the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">calculate_y_cython</em> module at line 2. If we look at the output to check the time taken for normal Python implementation and Cython version, they are <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">0.19</strong> and <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">0.16</strong> seconds respectively. The time difference is very low and we didn&#x27;t gain much from Cython because we haven&#x27;t done any optimization steps like </p><ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word"><li>static typing</li><li>limit calling Python&#x27;s libraries</li><li>reducing Python&#x27;s PyObject usage</li></ul><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Cython Annotations</h3><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Cython provides an easy way to check where we can optimize our Cython code by using Cython annotate feature. With the following command (<em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">-a</em> denotes annotate and <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">-3</em> denotes <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">language_level</strong> which is Python3), cython generates an HTML file that we can open in the browser to check for optimizable code. Another option is to pass the <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">annotate=True</strong> parameter to <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">cythonize()</em> function call in <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">ext_modules</strong> in <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">setup</em>.</p><pre><pre class="language-bash" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-bash" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>cython -a calculate_y_cython.pyx -3
</span></code></pre></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">If we open the generated HTML file in the browser, it will look like this</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><picture class="jsx-4051774662"><img src="/images/super-fast-python-cython/cython-annotations.png" alt="Cython Annotation" style="width:80%;max-width:80%;height:auto;margin-left:10%" class="jsx-4051774662"/><span class="jsx-4051774662 img-text"></span></picture></p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The more yellow lines the more interaction with the Python interpreter. Our goal should be converting as many yellow lines as to white lines that denote pure Cython code. We discuss the optimization part in a later section.</p><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Cython as an extension in Jupyter</h3><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Cython can be imported and used in Jupyter directly as an extension without the need for any additional build/compilation steps. </p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">First load the Cython extension using <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">%load_ext cython</em>, and then, for the cell that is to be Cythonized, use the magic command <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">%%cython</em> at the top of that cell as shown in the following image.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><picture class="jsx-4051774662"><img src="/images/super-fast-python-cython/cython-jupyter.png" alt="Cython Jupyter" style="width:40%;max-width:40%;height:auto;margin-left:30%" class="jsx-4051774662"/><span class="jsx-4051774662 img-text"></span></picture></p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">We can show the interactive Cython annotations in Jupyter just like we have generated the HTML file above. To show annotations, pass annotate option to <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">%%cython -a</em> magic command.</p><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Import &#x27;.pyx&#x27; using pyximport</h3><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">While developing or debugging, for each change in the &#x27;.pyx&#x27; file, running <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">setup.py</em> is a repetitive task and cumbersome. Instead, we can dynamically import &#x27;.pyx&#x27; to Python directly using <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#pyximport">pyximport</a> without any external build and compilation. <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">pyximport</em> takes care of compiling and building in the background without calling <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">cythonize()</em> internally. So, while importing the &#x27;.pyx&#x27; file, it will take some time to be imported as a regular Python module.</p><pre><pre class="language-python" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">import</span><span> pyximport
</span><span>pyximport</span><span class="token" style="color:#d4d4d4">.</span><span>install</span><span class="token" style="color:#d4d4d4">(</span><span>language_level</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token" style="color:#569CD6">from</span><span> calculate_y_cython </span><span class="token" style="color:#569CD6">import</span><span> calculate_y_cython
</span></code></pre></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Though it is easy to work with Cython using <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">pyximport</strong>, there are some <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#limitations">limitations with pyximport</a> and it is also not flexible as normal setup.</p><blockquote style="font-style:italic;background-color:#20a4f326;padding:10px;margin:1vh 0 1vh 0;border-left:5px solid #20a4f3e6"><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">It is not recommended to use <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">pyximport</strong> while distributing Python packages and modules.</p></blockquote><hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/><h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Optimize Cython</h2><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">In the previous section, we have seen in the Cython annotations HTML file that many areas in the code need to be optimized for more speed. There are several ways to improve speed like</p><ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word"><li>define static types</li><li>use C-libraries and functions</li><li>utilize OpenMP for parallel computing</li></ul><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Define static types to variables</h3><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Since Python is a dynamic typing language, we can define C-like data types for Python variables in Cython. To declare C variables, prefix the <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">cdef</strong> keyword to the variable declaration which is the same as declaring variables in C.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The syntax for variable declaration is</p><pre><pre class="language-python" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>cdef </span><span class="token" style="color:#ce9178">type</span><span> variable_name </span><span class="token" style="color:#d4d4d4">=</span><span> initilization_value </span><span class="token" style="color:#d4d4d4">{</span><span>optional</span><span class="token" style="color:#d4d4d4">}</span><span>
</span></code></pre></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">type</strong> can be any of the acceptable C data types.</p><h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Define function definitions</h3><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Python functions are defined using <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">def</strong> and <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#python-functions-vs-c-functions">C functions in Cython</a> are defined with the keyword <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">cdef</strong>. The difference between <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">def</strong> and <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">cdef</strong> is that with the former declaration, it can be called from anywhere both local and external modules where as <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">cdef</strong> functions are only module level. Also, Cython wraps the <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">def</strong> function that is defined inside &#x27;.pyx&#x27; into a Python object. There is another declaration called <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">cpdef</strong> which behaves as <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">def</strong> when called from outside the module and behaves as <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">cdef</strong> inside the module, so it is faster inside the same module function call.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Cython also provides support for writing function definitions just like C. We can define parameter types and return types. </p><pre><pre class="language-python" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>cdef</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569CD6">or</span><span> cpdef</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#ce9178">type</span><span> function_name</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">type</span><span> parameter1</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#d4d4d4">.</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></code></pre></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">If no type is specified, the parameters and return values are treated as Python objects which need Python interpretation and they are slow.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Now, make some changes to <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">calculate_y_cython.pyx</em> with static type declarations and function definitions as,</p><blockquote style="font-style:italic;background-color:#20a4f326;padding:10px;margin:1vh 0 1vh 0;border-left:5px solid #20a4f3e6"><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/tutorial/external.html">Call the C functions in Cython</a> inplace of Python functions that reduces the Python interaction.</p></blockquote><pre><div class="jsx-2122502216"><div class="jsx-2122502216 file-name-container"><p class="jsx-2122502216 file-name">calculate_y_cython.pyx</p></div><pre class="language-python:calculate_y_cython.pyx" style="color:#1d2b35;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0px;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-bottom:1vh;border-bottom-left-radius:5px;border-bottom-right-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>ctypedef </span><span class="token" style="color:#ce9178">long</span><span> </span><span class="token" style="color:#ce9178">int</span><span> li
</span><span>ctypedef </span><span class="token" style="color:#ce9178">long</span><span> </span><span class="token" style="color:#ce9178">long</span><span> </span><span class="token" style="color:#ce9178">int</span><span> lli
</span>
<span>cdef lli fx</span><span class="token" style="color:#d4d4d4">(</span><span>li x</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    cdef </span><span class="token" style="color:#ce9178">int</span><span> d </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>a </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> c
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> a</span><span class="token" style="color:#d4d4d4">*</span><span>x </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> c</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> d
</span>
<span>cdef double y</span><span class="token" style="color:#d4d4d4">(</span><span>li x</span><span class="token" style="color:#d4d4d4">,</span><span> li n</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    cdef</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        lli af </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span>
</span><span>        li k </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">abs</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">//</span><span class="token" style="color:#b5cea8">2</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span> x</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>        lli bf </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>k</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>af</span><span class="token" style="color:#d4d4d4">-</span><span>bf</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">/</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">1e-12</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span>cpdef calculate_y_cython</span><span class="token" style="color:#d4d4d4">(</span><span>li n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    ys </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#d4d4d4">]</span><span>
</span><span>    cdef</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        </span><span class="token" style="color:#ce9178">int</span><span> a </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">,</span><span> b </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">5</span><span class="token" style="color:#d4d4d4">,</span><span> c </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">4</span><span>
</span><span>        li i </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">for</span><span> i </span><span class="token" style="color:#569CD6">in</span><span> </span><span class="token" style="color:#ce9178">range</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        ys</span><span class="token" style="color:#d4d4d4">.</span><span>append</span><span class="token" style="color:#d4d4d4">(</span><span>y</span><span class="token" style="color:#d4d4d4">(</span><span>i</span><span class="token" style="color:#d4d4d4">,</span><span> n</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>    
<span>    </span><span class="token" style="color:#569CD6">return</span><span> ys
</span></code></pre></div></pre><blockquote style="font-style:italic;background-color:#20a4f326;padding:10px;margin:1vh 0 1vh 0;border-left:5px solid #20a4f3e6"><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">speed can be improved further by disabling bound checking(@cython.boundscheck(False)) and negative indexing(@cython.wraparound(False)) <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#compiler-directives">compiler directive instructions</a>.</p></blockquote><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Check the annotations for the Cython code, most of the yellow lines are now changed to white and only list operations are dark yellow because lists are Python objects. In a later section, we discuss optimizing lists using C arrays.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><picture class="jsx-4051774662"><img src="/images/super-fast-python-cython/optimized_cython.jpg" alt="Optimized Cython Annotation" style="width:70%;max-width:70%;height:auto;margin-left:15%" class="jsx-4051774662"/><span class="jsx-4051774662 img-text"></span></picture></p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">If we check the time for the optimized Cython code,</p><pre><pre class="language-python" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">%</span><span class="token" style="color:#d4d4d4">%</span><span>timeit </span><span class="token" style="color:#d4d4d4">-</span><span>n </span><span class="token" style="color:#b5cea8">100</span><span>
</span><span>n </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">100000</span><span>
</span><span>res </span><span class="token" style="color:#d4d4d4">=</span><span> calculate_y_cython</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token triple-quoted-string" style="color:#ce9178">&quot;&quot;&quot;Output:
</span><span class="token triple-quoted-string" style="color:#ce9178">2.04 ms  166 s per loop (mean  std. dev. of 7 runs, 100 loops each)
</span><span class="token triple-quoted-string" style="color:#ce9178">&quot;&quot;&quot;</span><span>
</span></code></pre></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">it takes <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">0.002</strong> seconds which is approximately <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">100x</strong> times faster than the normal Python version that takes <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">0.19</strong> seconds. By adding only static type and some tweaks, we made Python 100x faster. The powers of Cython are not limited to only static typing. We can further speed up the code with Numpy.</p><hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/><h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">1000x times faster with MemoryView and Numpy</h2><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">In the Cython annotation snippet above, we see that the list operations of <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">ys</strong> are still yellow as <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">list()</em> is a python object and Cython cannot optimize Python objects interaction. </p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">To solve this, we can convert the list type to <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/tutorial/array.html">memoryview arrays</a>, and operations like <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">append()</em> to indexing just like looping in C.</p><pre><div class="jsx-2122502216"><div class="jsx-2122502216 file-name-container"><p class="jsx-2122502216 file-name">calculate_y_cython.pyx</p></div><pre class="language-python:calculate_y_cython.pyx" style="color:#1d2b35;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0px;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-bottom:1vh;border-bottom-left-radius:5px;border-bottom-right-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>cimport cython
</span><span></span><span class="token" style="color:#569CD6">import</span><span> numpy </span><span class="token" style="color:#569CD6">as</span><span> np
</span><span>cimport numpy </span><span class="token" style="color:#569CD6">as</span><span> np
</span>
<span>ctypedef </span><span class="token" style="color:#ce9178">long</span><span> </span><span class="token" style="color:#ce9178">int</span><span> li
</span><span>ctypedef </span><span class="token" style="color:#ce9178">long</span><span> </span><span class="token" style="color:#ce9178">long</span><span> </span><span class="token" style="color:#ce9178">int</span><span> lli
</span>
<span></span><span class="token decorator annotation" style="color:#d4d4d4">@cython</span><span class="token decorator annotation" style="color:#d4d4d4">.</span><span class="token decorator annotation" style="color:#d4d4d4">boundscheck</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569cd6">False</span><span class="token" style="color:#d4d4d4">)</span><span>  </span><span class="token" style="color:#6a9955"># Deactivate bounds checking</span><span>
</span><span></span><span class="token decorator annotation" style="color:#d4d4d4">@cython</span><span class="token decorator annotation" style="color:#d4d4d4">.</span><span class="token decorator annotation" style="color:#d4d4d4">wraparound</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569cd6">False</span><span class="token" style="color:#d4d4d4">)</span><span>   </span><span class="token" style="color:#6a9955"># Deactivate negative indexing</span><span>
</span><span>cdef lli fx</span><span class="token" style="color:#d4d4d4">(</span><span>li x</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    cdef </span><span class="token" style="color:#ce9178">int</span><span> d </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>a </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> c
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> a</span><span class="token" style="color:#d4d4d4">*</span><span>x </span><span class="token" style="color:#d4d4d4">+</span><span> b</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> c</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">3</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> d
</span>
<span></span><span class="token decorator annotation" style="color:#d4d4d4">@cython</span><span class="token decorator annotation" style="color:#d4d4d4">.</span><span class="token decorator annotation" style="color:#d4d4d4">boundscheck</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569cd6">False</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token decorator annotation" style="color:#d4d4d4">@cython</span><span class="token decorator annotation" style="color:#d4d4d4">.</span><span class="token decorator annotation" style="color:#d4d4d4">wraparound</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569cd6">False</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>cdef double y</span><span class="token" style="color:#d4d4d4">(</span><span>li x</span><span class="token" style="color:#d4d4d4">,</span><span> li n</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">int</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    cdef</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        lli af </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>x</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">**</span><span class="token" style="color:#b5cea8">2</span><span>
</span><span>        li k </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">abs</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">//</span><span class="token" style="color:#b5cea8">2</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span> x</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>        lli bf </span><span class="token" style="color:#d4d4d4">=</span><span> fx</span><span class="token" style="color:#d4d4d4">(</span><span>k</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>af</span><span class="token" style="color:#d4d4d4">-</span><span>bf</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">/</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">1e-12</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token decorator annotation" style="color:#d4d4d4">@cython</span><span class="token decorator annotation" style="color:#d4d4d4">.</span><span class="token decorator annotation" style="color:#d4d4d4">boundscheck</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569cd6">False</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token decorator annotation" style="color:#d4d4d4">@cython</span><span class="token decorator annotation" style="color:#d4d4d4">.</span><span class="token decorator annotation" style="color:#d4d4d4">wraparound</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#569cd6">False</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>cpdef calculate_y_cython</span><span class="token" style="color:#d4d4d4">(</span><span>li n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>    cdef double</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#d4d4d4">:</span><span class="token" style="color:#d4d4d4">]</span><span> ys </span><span class="token" style="color:#d4d4d4">=</span><span> np</span><span class="token" style="color:#d4d4d4">.</span><span>empty</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">,</span><span> dtype</span><span class="token" style="color:#d4d4d4">=</span><span>np</span><span class="token" style="color:#d4d4d4">.</span><span>float64</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    cdef</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        </span><span class="token" style="color:#ce9178">int</span><span> a </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">2</span><span class="token" style="color:#d4d4d4">,</span><span> b </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">5</span><span class="token" style="color:#d4d4d4">,</span><span> c </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">-</span><span class="token" style="color:#b5cea8">4</span><span>
</span><span>        li i </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">0</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">for</span><span> i </span><span class="token" style="color:#569CD6">in</span><span> </span><span class="token" style="color:#ce9178">range</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span>
</span><span>        ys</span><span class="token" style="color:#d4d4d4">[</span><span>i</span><span class="token" style="color:#d4d4d4">]</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> y</span><span class="token" style="color:#d4d4d4">(</span><span>i</span><span class="token" style="color:#d4d4d4">,</span><span> n</span><span class="token" style="color:#d4d4d4">,</span><span> a</span><span class="token" style="color:#d4d4d4">,</span><span> b</span><span class="token" style="color:#d4d4d4">,</span><span> c</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#569CD6">return</span><span> ys
</span></code></pre></div></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Before building the object code, we need to change <a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://cython.readthedocs.io/en/stable/src/tutorial/numpy.html">build instructions to link Numpy</a> as a dependency like following</p><pre><div class="jsx-2122502216"><div class="jsx-2122502216 file-name-container"><p class="jsx-2122502216 file-name">setup.py</p></div><pre class="language-python:setup.py" style="color:#1d2b35;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0px;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-bottom:1vh;border-bottom-left-radius:5px;border-bottom-right-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#569CD6">from</span><span> distutils</span><span class="token" style="color:#d4d4d4">.</span><span>core </span><span class="token" style="color:#569CD6">import</span><span> setup
</span><span></span><span class="token" style="color:#569CD6">from</span><span> distutils</span><span class="token" style="color:#d4d4d4">.</span><span>extension </span><span class="token" style="color:#569CD6">import</span><span> Extension
</span><span></span><span class="token" style="color:#569CD6">from</span><span> Cython</span><span class="token" style="color:#d4d4d4">.</span><span>Build </span><span class="token" style="color:#569CD6">import</span><span> cythonize
</span><span></span><span class="token" style="color:#569CD6">import</span><span> numpy
</span>
<span>ext_modules </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span>
</span><span>    Extension</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&quot;calculate_y_function&quot;</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>              sources</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#ce9178">&quot;calculate_y_cython.pyx&quot;</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>              libraries</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#d4d4d4">[</span><span class="token" style="color:#ce9178">&quot;m&quot;</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>              compiler_directives</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#d4d4d4">{</span><span class="token" style="color:#ce9178">&quot;language_level&quot;</span><span class="token" style="color:#d4d4d4">:</span><span> </span><span class="token" style="color:#ce9178">&quot;3&quot;</span><span class="token" style="color:#d4d4d4">}</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>              </span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">]</span><span>
</span>
<span>setup</span><span class="token" style="color:#d4d4d4">(</span><span>name</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#ce9178">&quot;calculate Y function&quot;</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>      ext_modules</span><span class="token" style="color:#d4d4d4">=</span><span>cythonize</span><span class="token" style="color:#d4d4d4">(</span><span>ext_modules</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>      include_dirs</span><span class="token" style="color:#d4d4d4">=</span><span class="token" style="color:#d4d4d4">[</span><span>numpy</span><span class="token" style="color:#d4d4d4">.</span><span>get_include</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span>
</span></code></pre></div></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The parameter <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">include_dirs</em> includes external libraries like Numpy here.</p><pre><pre class="language-python" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:0px;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-python" style="color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">%</span><span class="token" style="color:#d4d4d4">%</span><span>timeit </span><span class="token" style="color:#d4d4d4">-</span><span>n </span><span class="token" style="color:#b5cea8">1000</span><span>
</span><span>n </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">100000</span><span>
</span><span>res </span><span class="token" style="color:#d4d4d4">=</span><span> calculate_y_cython</span><span class="token" style="color:#d4d4d4">(</span><span>n</span><span class="token" style="color:#d4d4d4">)</span><span>
</span>
<span></span><span class="token triple-quoted-string" style="color:#ce9178">&quot;&quot;&quot;Output:
</span><span class="token triple-quoted-string" style="color:#ce9178">208 s  11.3 s per loop (mean  std. dev. of 7 runs, 1000 loops each)
</span><span class="token triple-quoted-string" style="color:#ce9178">&quot;&quot;&quot;</span><span>
</span></code></pre></pre><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The fully optimized version of Cython runs at <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">0.0002</strong> seconds which is approximately <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">1000x</strong> faster than the normal Python code. </p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The usage of Numpy and MemoryViews in Cython needs separate discussion and I will write about Classes, C-math, Numpy, MemoryViews, and OpenMP in the Advanced Cython series later.</p><hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Cython is a very powerful extension that we can use to speed up Python code. Sometimes it may not be possible to convert Python objects straight away like dictionaries (use C++ maps), so it&#x27;s better to use Cython for repetitive tasks like loops, general functions with simple statements (like declaration and usage only), and math operations.</p><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Learn more about Cython by referencing</p><ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word"><li><a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="http://blog.behnel.de/posts/tuning-basic-object-operations-in-cython.html">Speeding up basic object operations in Cython
</a></li><li><a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://www.infoworld.com/article/3648539/faster-python-made-easier-with-cythons-pure-python-mode.html">Faster Python made easier with Cythons pure Python mode</a></li><li><a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://www.peterbaumgartner.com/blog/intro-to-just-enough-cython-to-be-useful/">An Introduction to Just Enough Cython to be Useful</a></li><li><a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://nicolas-hug.com/blog/cython_notes">Cython notes and tips</a></li><li><a style="color:#071013;text-decoration:none;cursor:pointer;border-bottom:1px dashed #fb232e;font-size:calc(1rem + 0.1vw);font-weight:bold;overflow-wrap:break-word" target="_blank" rel="noreferrer" href="https://github.com/cython/cython/issues/3974">(Github Issue) Improve cython interface with a more user-friendly compiling interface</a></li></ul></article><div class="jsx-1393389675 footer-container"><div class="jsx-1393389675 footer-container-links"><div class="jsx-1393389675 footer-links"><div class="jsx-1393389675 link-item"><a href="https://github.com/santhalakshminarayana" rel="noreferrer" target=" _blank" class="jsx-1393389675 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div></a></div><div class="jsx-1393389675 link-item"><a href="https://www.linkedin.com/in/santhalakshminarayana/" rel="noreferrer" target="_blank" class="jsx-1393389675 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></div></a></div><div class="jsx-1393389675 link-item"><a href="https://medium.com/@santhalakshminarayana/" rel="noreferrer" target="_blank" class="jsx-1393389675 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M13.54 12a6.8 6.8 0 01-6.77 6.82A6.8 6.8 0 010 12a6.8 6.8 0 016.77-6.82A6.8 6.8 0 0113.54 12zM20.96 12c0 3.54-1.51 6.42-3.38 6.42-1.87 0-3.39-2.88-3.39-6.42s1.52-6.42 3.39-6.42 3.38 2.88 3.38 6.42M24 12c0 3.17-.53 5.75-1.19 5.75-.66 0-1.19-2.58-1.19-5.75s.53-5.75 1.19-5.75C23.47 6.25 24 8.83 24 12z"></path></svg></div></a></div><div class="jsx-1393389675 link-item"><a href="https://www.kaggle.com/santhalnr/" rel="noreferrer" target="_blank" class="jsx-1393389675 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M.1025 7.3475c-.0681 0-.1022.0341-.1022.102v6.752c0 .0681.034.1022.1022.1022h.7049c.068 0 .1022-.034.1022-.1023v-1.481l.4187-.3985 1.5016 1.91c.041.0477.0884.0716.143.0716h.9091c.0476 0 .0748-.0135.0817-.0407.0135-.041.0066-.075-.0206-.1023l-1.9816-2.4618 1.9002-1.8384c.0204-.0205.0237-.051.01-.092-.0137-.0339-.0408-.051-.0816-.051h-.9398c-.0477 0-.0953.024-.143.0716L.9096 11.607V7.4496c0-.0679-.0342-.102-.1022-.102zm18.0417 0c-.068 0-.102.0341-.102.102v6.752c0 .0681.034.102.102.102h.705c.068 0 .102-.034.102-.102v-6.752c0-.068-.034-.102-.102-.102zM5.961 9.6254c-.5653 0-1.11.1806-1.6343.5415-.0545.0545-.0648.102-.0307.143l.3676.5208c.0272.0477.0717.0545.133.0204.3948-.2722.783-.4086 1.1644-.4086.2927 0 .5158.0886.669.2656.1532.1771.2197.3917.1992.6436-.6606.0681-1.1545.1495-1.4813.245-.8308.2383-1.2461.6913-1.2461 1.3586 0 .4222.1533.7695.4598 1.0419.3132.2654.6845.3982 1.1134.3982.4698 0 .8545-.1125 1.1542-.3372v.1432c0 .0682.0374.102.1123.102h.7048c.068 0 .102-.0338.102-.102V11.372c0-.6604-.2245-1.1406-.6739-1.4403-.3065-.2043-.6776-.3063-1.1134-.3063zm4.3225 0c-.6742 0-1.195.2622-1.5627.7865-.3133.4359-.4699.9671-.4699 1.5936 0 .6604.1634 1.2087.4903 1.6444.3744.4972.892.7455 1.5526.7455.5313 0 .9567-.1327 1.2768-.3982v.531c0 .858-.4122 1.287-1.236 1.287-.361 0-.732-.1907-1.1132-.572a.098.098 0 00-.0716-.0306c-.034 0-.0613.0102-.0817.0307l-.4802.48c-.0408.0613-.0375.1124.0103.1532.1361.1157.2554.2129.3576.2911.102.0783.1905.1413.2656.189.354.1975.7284.2961 1.1235.2961.6808 0 1.207-.1925 1.5781-.577.3711-.3848.5567-.9484.5567-1.6903V9.8196c0-.068-.034-.102-.102-.102h-.705c-.0682 0-.1021.034-.1021.102v.2043c-.3471-.2657-.7763-.3985-1.287-.3985zm4.8021 0c-.6742 0-1.195.2622-1.5627.7865-.3132.4359-.4699.9671-.4699 1.5936 0 .6604.1633 1.2087.4903 1.6444.3744.4972.892.7455 1.5526.7455.5311 0 .9566-.1327 1.2768-.3982v.531c0 .858-.4122 1.287-1.236 1.287-.361 0-.732-.1907-1.1133-.572a.098.098 0 00-.0716-.0306c-.034 0-.0612.0102-.0816.0307l-.48.48c-.0409.0613-.0376.1124.01.1532.1363.1157.2555.2129.3576.2911.1021.0783.1906.1413.2657.189.354.1975.7285.2961 1.1237.2961.6808 0 1.2068-.1925 1.5781-.577.371-.3848.5565-.9484.5565-1.6903V9.8196c0-.068-.034-.102-.102-.102h-.7049c-.0682 0-.1022.034-.1022.102v.2043c-.3474-.2657-.7763-.3985-1.287-.3985zm6.7457 0c-.6537 0-1.185.211-1.5936.6332-.4427.4632-.664 1.0283-.664 1.6956 0 .7083.225 1.2905.6743 1.7467.463.463 1.042.6945 1.7366.6945.6467 0 1.2154-.1838 1.7057-.5515.0545-.041.0545-.0884 0-.143l-.4802-.4903c-.041-.0409-.0919-.0409-.1533 0-.2998.2112-.6368.3167-1.0112.3167-.4222 0-.7729-.119-1.052-.3576-.2452-.2248-.3882-.5038-.429-.8375h3.3197c.0679 0 .1022-.0341.1022-.1023l.01-.2244c.0341-.6878-.1668-1.26-.6025-1.7162-.4224-.4426-.9432-.664-1.5627-.664zm-.0206.7865c.3268 0 .6062.1056.8377.3166.2452.211.371.4734.378.7865h-2.4618c.0613-.3269.2077-.5925.4392-.7968.2313-.2042.5004-.3063.8069-.3063zm-11.4249.102c.6196 0 1.0146.2181 1.1848.6538v1.6854c-.1702.4358-.5755.6538-1.2155.6538-.3133 0-.5687-.0986-.7661-.2963-.2656-.2518-.3983-.6538-.3983-1.2053 0-.9941.3984-1.4914 1.1951-1.4914zm4.802 0c.6196 0 1.0148.2181 1.1851.6538h-.0002v1.6854c-.1703.4358-.5755.6538-1.2155.6538-.3132 0-.5686-.0986-.7661-.2963-.2655-.2518-.3983-.6538-.3983-1.2053 0-.9941.3983-1.4914 1.195-1.4914zm-8.3586 1.6547v1.0215c-.286.286-.6675.412-1.1441.3779-.1703-.0135-.32-.0663-.4493-.1582-.1294-.0919-.2045-.2129-.2249-.3627-.0341-.2657.1158-.47.4495-.6129.2452-.1088.7013-.1974 1.3688-.2656z"></path></svg></div></a></div><div class="jsx-1393389675 link-item"><a href="https://www.quora.com/profile/Lakshmi-Narayana-217" rel="noreferrer" target="_blank" class="jsx-1393389675 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.646-1.289c.786-.678 2.058-1.214 3.693-1.214 2.544 0 3.851 1.229 4.888 2.792.613-1.335.904-3.14.904-5.375 0-5.582-1.744-8.447-5.822-8.447-4.018 0-5.757 2.865-5.757 8.447 0 5.553 1.739 8.389 5.757 8.389.64 0 1.22-.069 1.75-.225zm.996 1.947c-.881.237-1.817.366-2.743.366-5.352 0-10.59-4.269-10.59-10.478C.402 4.271 5.639 0 10.991 0c5.441 0 10.628 4.238 10.628 10.537 0 3.504-1.635 6.351-4.01 8.191.764 1.148 1.543 1.914 2.652 1.914 1.199 0 1.68-.915 1.77-1.649h1.557c.092.974-.402 5.007-4.766 5.007-2.652 0-4.047-1.528-5.096-3.328l.008-.024z"></path></svg></div></a></div></div></div><div class="jsx-1393389675 copy-right-container"><p class="jsx-1393389675 copy-right-text">Santha Lakshmi Narayana  2022</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postMetadata":{"title":"Super fast Python (Part-4): Cython","description":"Convert slow Python code to run as fast as C/C++ using Cython.","imgName":"super-fast-python-cython/super-fast-python-cython.jpg","date":"Nov 18, 2022","tags":["python-performance"],"keywords":["cython","python-performance'","python-optimize","python","fast-python","speed","python"],"id":"super-fast-python-cython"},"postContent":{"compiledSource":"var c=Object.defineProperty,m=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var i=Object.getOwnPropertySymbols;var r=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;var s=(t,n,a)=\u003en in t?c(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,e=(t,n)=\u003e{for(var a in n||(n={}))r.call(n,a)\u0026\u0026s(t,a,n[a]);if(i)for(var a of i(n))p.call(n,a)\u0026\u0026s(t,a,n[a]);return t},l=(t,n)=\u003em(t,y(n));var h=(t,n)=\u003e{var a={};for(var o in t)r.call(t,o)\u0026\u0026n.indexOf(o)\u003c0\u0026\u0026(a[o]=t[o]);if(t!=null\u0026\u0026i)for(var o of i(t))n.indexOf(o)\u003c0\u0026\u0026p.call(t,o)\u0026\u0026(a[o]=t[o]);return a};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(a){var o=a,{components:t}=o,n=h(o,[\"components\"]);return mdx(MDXLayout,l(e(e({},layoutProps),n),{components:t,mdxType:\"MDXLayout\"}),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"super-fast-python-cython/super-fast-python-cython.jpg\",alt:\"Super fast Python\"}))),mdx(\"h1\",null,\"Super fast Python (Part-4): Cython\"),mdx(\"p\",null,\"This is the fourth post in the series on Python performance and Optimization. The series points out the utilization of inbuilt libraries, low-level code conversions, and other Python implementations to speed-up Python. The other posts included in this series are \"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"(Part-1): \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://santhalakshminarayana.github.io/blog/super-fast-python-why-python-slow\"}),\"Why Python is slow?\")),mdx(\"li\",{parentName:\"ul\"},\"(Part-2): \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://santhalakshminarayana.github.io/blog/super-fast-python-good-practices\"}),\"Good practices to write fast Python code\")),mdx(\"li\",{parentName:\"ul\"},\"(Part-3): \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://santhalakshminarayana.github.io/blog/super-fast-python-multi-processing\"}),\"Multi-processing in Python\")),mdx(\"li\",{parentName:\"ul\"},\"(Part-4): Use Cython to get speed as fast as C (this post)\"),mdx(\"li\",{parentName:\"ul\"},\"(Part-5): Use Numba to speed up Python Functions and Classes\")),mdx(\"p\",null,\"In the last post, we discussed \",mdx(\"strong\",{parentName:\"p\"},\"multiprocessing\"),\" to optimize Python code by utilizing parallel computing with multiple CPU cores. Multi-processing is useful when we can split certain parts of code into parallel tasks and then execute them parallelly. \"),mdx(\"p\",null,\"Imagine when we don't have any parallelizable code and it is taking huge time in Python compared to \",mdx(\"strong\",{parentName:\"p\"},\"C/C++\"),\", how to optimize the code then? One thing we can do is to convert the Python code into a low-level programming language like C/C++ and \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.python.org/3/extending/extending.html\"}),\"embed that C/C++ code in Python\"),\". Understanding and writing C/C++ code is hard for someone who is not familiar with C/C++. Fortunately, we can get the performance speed as fast as C/C++ by writing the Python code in \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.org/\"}),\"Cython\"),\" which is a superset of Python that provides functionality to write C-Extensions for Python.\"),mdx(\"h2\",null,\"How Cython can improve Speed?\"),mdx(\"p\",null,\"In our previous discussion on \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://santhalakshminarayana.github.io/blog/super-fast-python-why-python-slow\"}),\"Why Python is slow?\"),\", we learned that the major speed issues arise in Python due to\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"interpretation of generated bytecode\"),mdx(\"li\",{parentName:\"ul\"},\"dynamic types and their management\")),mdx(\"p\",null,\"With Cython, we can take care of the above problems with both compiled code instead of interpretation and static typing instead of dynamic typing. \"),mdx(\"p\",null,\"Cython translates the Python code into C extension code and compiles the C code into an object code that can be imported directly into Python. Also, we can make some changes like adding static types that improve the execution speed drastically over dynamic typing. Cython also supports the usage of C/C++ libraries and functions that are super-fast compared to Python libraries and functions.\"),mdx(\"h3\",null,\"Install Cython\"),mdx(\"p\",null,mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/quickstart/install.html\"}),\"Install the Cython\"),\" with Pip as follows\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),`pip install Cython\n`)),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"To compile the C code into an object file, we need a C compiler. Ubuntu comes with \",mdx(\"strong\",{parentName:\"p\"},\"gcc\"),\" by default. For other platforms like Windows, install the C compiler if not installed previously.\")),mdx(\"hr\",null),mdx(\"h2\",null,\"Cython usage\"),mdx(\"p\",null,\"There are multiple ways to use Cython like building manually,  using in Jupyter as an extension, or importing directly like a Python module without compilation using \",mdx(\"em\",{parentName:\"p\"},\"pyximport\"),\".\"),mdx(\"h3\",null,\"Build a Cython module manually\"),mdx(\"p\",null,\"We write the Cython code in a file with the extension \",mdx(\"em\",{parentName:\"p\"},\".pyx\"),\" instead of the normal Python extension \",mdx(\"em\",{parentName:\"p\"},\".py\"),\".\"),mdx(\"p\",null,\"The compiler translates '.pyx' Cython file into a '.c' C file and then compiles that C file to a sharable object file '.so' (or '.pyd' on Windows). We tell the compiler those build instructions and compilation options by writing a \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#basic-setup-py\"}),\"setup.py\"),\" file.\"),mdx(\"h3\",null,\"Cython compilation\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Translate the \",mdx(\"em\",{parentName:\"li\"},\".pyx\"),\" source code to a \",mdx(\"em\",{parentName:\"li\"},\".c\"),\" file with additional wrappers of Python extension code.\"),mdx(\"li\",{parentName:\"ul\"},\"Compile the \",mdx(\"em\",{parentName:\"li\"},\".c\"),\" file with a C compiler to a platform-specific shared object file \",mdx(\"em\",{parentName:\"li\"},\".so\"),\" that can be imported directly into Python.\")),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python:calculate_y_cython.pyx\"}),`def fx(x, a, b, c):\n    d = (a + b) * c\n    return a*x + b*(x**2) + c*(x**3) + d\n\ndef y(x, n, a, b, c):\n    af = fx(x, a, b, c)**2\n    k = abs(n//2 - x)\n    bf = fx(k, a, b, c)\n    return (af-bf)/(n-1 + 1e-12)\n\ndef calculate_y_cython(n):\n    ys = []\n    a, b, c = 2, 5, -4\n    for i in range(n):\n        ys.append(y(i, n, a, b, c))\n    \n    return ys\n`)),mdx(\"p\",null,\"The above file \",mdx(\"em\",{parentName:\"p\"},\"calculate_y.pyx\"),\" contains Cython code that looks the same as Python without any optimizations. Now to compile the above file, write a \",mdx(\"em\",{parentName:\"p\"},\"setup.py\"),\" file as following\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python:setup.py\"}),`from distutils.core import setup\nfrom Cython.Build import cythonize\n\nsetup(\n    name='Calculate Expression Y',\n    ext_modules=cythonize(\n        \"calculate_y_cython.pyx\", \n        compiler_directives={\"language_level\": \"3\"},\n    )\n)\n`)),mdx(\"p\",null,\"In the above \",mdx(\"em\",{parentName:\"p\"},\"setup.py\"),\", for the \",mdx(\"strong\",{parentName:\"p\"},\"setup()\"),\", we have passed the optional name to our Cython module for \",mdx(\"em\",{parentName:\"p\"},\"name\"),\" and the path to the \",mdx(\"em\",{parentName:\"p\"},\".pyx\"),\" file for the \",mdx(\"em\",{parentName:\"p\"},\"ext_module\"),\" parameter.\"),mdx(\"p\",null,\"Build the sharable object file '.so' using the following command in the terminal\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),`python setup.py build_ext --inplace\nor\npython setup.py build_ext --inplace --quiet\n`)),mdx(\"p\",null,\"This will generate a translated '.c' C file and a compiled '.so' file.\"),mdx(\"p\",null,\"We can import the above compiled \",mdx(\"em\",{parentName:\"p\"},\"calculate_y_cython\"),\" module directly into Python runtime.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python:main.py\"}),`from time import perf_counter\nfrom calculate_y_cython import calculate_y_cython\n\ndef fx(x, a, b, c):\n    d = (a + b) * c\n    return a*x + b*(x**2) + c*(x**3) + d\n\ndef y(x, n, a, b, c):\n    af = fx(x, a, b, c)**2\n    k = abs(n//2 - x)\n    bf = fx(k, a, b, c)\n    return (af-bf)/(n-1 + 1e-12)\n\ndef calculate_y_py(n):\n    ys = []\n    a, b, c = 2, 5, -4\n    for i in range(n):\n        ys.append(y(i, n, a, b, c))\n    \n    return ys\n\ndef main():\n    n = 100000\n    # Python implementation\n    atime = perf_counter()\n    res = calculate_y_py(n)\n    print(f'Python Time: {perf_counter()-atime:.2}')\n    \n    atime = perf_counter()\n    res = calculate_y_cython(n)\n    print(f'Cython Time: {perf_counter()-atime:.2}')\n    \nif __name__==\"__main__\":\n    main()\n\n\"\"\"Output:\nPython Time: 0.19\nCython Time: 0.16\n\"\"\"\n`)),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"At the time of writing, the latest Python version is Python 3.11 which is incredibly faster (30-60% in some cases) than earlier versions. So, to understand the Cython potential, I'm running the scripts in Python 3.8.10 on my old system with 8GB Intel(R) i5-8250U 1.60GHz CPU on HP Laptop 15-da0xxx.\")),mdx(\"p\",null,\"In the above \",mdx(\"em\",{parentName:\"p\"},\"main.py\"),\", we have imported the \",mdx(\"em\",{parentName:\"p\"},\"calculate_y_cython\"),\" module at line 2. If we look at the output to check the time taken for normal Python implementation and Cython version, they are \",mdx(\"strong\",{parentName:\"p\"},\"0.19\"),\" and \",mdx(\"strong\",{parentName:\"p\"},\"0.16\"),\" seconds respectively. The time difference is very low and we didn't gain much from Cython because we haven't done any optimization steps like \"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"static typing\"),mdx(\"li\",{parentName:\"ul\"},\"limit calling Python's libraries\"),mdx(\"li\",{parentName:\"ul\"},\"reducing Python's PyObject usage\")),mdx(\"h3\",null,\"Cython Annotations\"),mdx(\"p\",null,\"Cython provides an easy way to check where we can optimize our Cython code by using Cython annotate feature. With the following command (\",mdx(\"em\",{parentName:\"p\"},\"-a\"),\" denotes annotate and \",mdx(\"em\",{parentName:\"p\"},\"-3\"),\" denotes \",mdx(\"strong\",{parentName:\"p\"},\"language_level\"),\" which is Python3), cython generates an HTML file that we can open in the browser to check for optimizable code. Another option is to pass the \",mdx(\"strong\",{parentName:\"p\"},\"annotate=True\"),\" parameter to \",mdx(\"em\",{parentName:\"p\"},\"cythonize()\"),\" function call in \",mdx(\"strong\",{parentName:\"p\"},\"ext_modules\"),\" in \",mdx(\"em\",{parentName:\"p\"},\"setup\"),\".\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),`cython -a calculate_y_cython.pyx -3\n`)),mdx(\"p\",null,\"If we open the generated HTML file in the browser, it will look like this\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"super-fast-python-cython/cython-annotations.png\",alt:\"Cython Annotation:=:80\"}))),mdx(\"p\",null,\"The more yellow lines the more interaction with the Python interpreter. Our goal should be converting as many yellow lines as to white lines that denote pure Cython code. We discuss the optimization part in a later section.\"),mdx(\"h3\",null,\"Cython as an extension in Jupyter\"),mdx(\"p\",null,\"Cython can be imported and used in Jupyter directly as an extension without the need for any additional build/compilation steps. \"),mdx(\"p\",null,\"First load the Cython extension using \",mdx(\"em\",{parentName:\"p\"},\"%load_ext cython\"),\", and then, for the cell that is to be Cythonized, use the magic command \",mdx(\"em\",{parentName:\"p\"},\"%%cython\"),\" at the top of that cell as shown in the following image.\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"super-fast-python-cython/cython-jupyter.png\",alt:\"Cython Jupyter:=:40\"}))),mdx(\"p\",null,\"We can show the interactive Cython annotations in Jupyter just like we have generated the HTML file above. To show annotations, pass annotate option to \",mdx(\"em\",{parentName:\"p\"},\"%%cython -a\"),\" magic command.\"),mdx(\"h3\",null,\"Import '.pyx' using pyximport\"),mdx(\"p\",null,\"While developing or debugging, for each change in the '.pyx' file, running \",mdx(\"em\",{parentName:\"p\"},\"setup.py\"),\" is a repetitive task and cumbersome. Instead, we can dynamically import '.pyx' to Python directly using \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#pyximport\"}),\"pyximport\"),\" without any external build and compilation. \",mdx(\"em\",{parentName:\"p\"},\"pyximport\"),\" takes care of compiling and building in the background without calling \",mdx(\"em\",{parentName:\"p\"},\"cythonize()\"),\" internally. So, while importing the '.pyx' file, it will take some time to be imported as a regular Python module.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`import pyximport\npyximport.install(language_level=3)\n\nfrom calculate_y_cython import calculate_y_cython\n`)),mdx(\"p\",null,\"Though it is easy to work with Cython using \",mdx(\"strong\",{parentName:\"p\"},\"pyximport\"),\", there are some \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#limitations\"}),\"limitations with pyximport\"),\" and it is also not flexible as normal setup.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"It is not recommended to use \",mdx(\"strong\",{parentName:\"p\"},\"pyximport\"),\" while distributing Python packages and modules.\")),mdx(\"hr\",null),mdx(\"h2\",null,\"Optimize Cython\"),mdx(\"p\",null,\"In the previous section, we have seen in the Cython annotations HTML file that many areas in the code need to be optimized for more speed. There are several ways to improve speed like\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"define static types\"),mdx(\"li\",{parentName:\"ul\"},\"use C-libraries and functions\"),mdx(\"li\",{parentName:\"ul\"},\"utilize OpenMP for parallel computing\")),mdx(\"h3\",null,\"Define static types to variables\"),mdx(\"p\",null,\"Since Python is a dynamic typing language, we can define C-like data types for Python variables in Cython. To declare C variables, prefix the \",mdx(\"strong\",{parentName:\"p\"},\"cdef\"),\" keyword to the variable declaration which is the same as declaring variables in C.\"),mdx(\"p\",null,\"The syntax for variable declaration is\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`cdef type variable_name = initilization_value {optional}\n`)),mdx(\"p\",null,\"The \",mdx(\"strong\",{parentName:\"p\"},\"type\"),\" can be any of the acceptable C data types.\"),mdx(\"h3\",null,\"Define function definitions\"),mdx(\"p\",null,\"Python functions are defined using \",mdx(\"strong\",{parentName:\"p\"},\"def\"),\" and \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#python-functions-vs-c-functions\"}),\"C functions in Cython\"),\" are defined with the keyword \",mdx(\"strong\",{parentName:\"p\"},\"cdef\"),\". The difference between \",mdx(\"strong\",{parentName:\"p\"},\"def\"),\" and \",mdx(\"strong\",{parentName:\"p\"},\"cdef\"),\" is that with the former declaration, it can be called from anywhere both local and external modules where as \",mdx(\"strong\",{parentName:\"p\"},\"cdef\"),\" functions are only module level. Also, Cython wraps the \",mdx(\"strong\",{parentName:\"p\"},\"def\"),\" function that is defined inside '.pyx' into a Python object. There is another declaration called \",mdx(\"strong\",{parentName:\"p\"},\"cpdef\"),\" which behaves as \",mdx(\"strong\",{parentName:\"p\"},\"def\"),\" when called from outside the module and behaves as \",mdx(\"strong\",{parentName:\"p\"},\"cdef\"),\" inside the module, so it is faster inside the same module function call.\"),mdx(\"p\",null,\"Cython also provides support for writing function definitions just like C. We can define parameter types and return types. \"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`cdef(or cpdef) type function_name(type parameter1, ...)\n`)),mdx(\"p\",null,\"If no type is specified, the parameters and return values are treated as Python objects which need Python interpretation and they are slow.\"),mdx(\"p\",null,\"Now, make some changes to \",mdx(\"em\",{parentName:\"p\"},\"calculate_y_cython.pyx\"),\" with static type declarations and function definitions as,\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/tutorial/external.html\"}),\"Call the C functions in Cython\"),\" inplace of Python functions that reduces the Python interaction.\")),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python:calculate_y_cython.pyx\"}),`ctypedef long int li\nctypedef long long int lli\n\ncdef lli fx(li x, int a, int b, int c):\n    cdef int d = (a + b) * c\n    return a*x + b*(x**2) + c*(x**3) + d\n\ncdef double y(li x, li n, int a, int b, int c):\n    cdef:\n        lli af = fx(x, a, b, c)**2\n        li k = abs(n//2 - x)\n        lli bf = fx(k, a, b, c)\n    return (af-bf)/(n-1 + 1e-12)\n\ncpdef calculate_y_cython(li n):\n    ys = []\n    cdef:\n        int a = 2, b = 5, c = -4\n        li i = 0\n    for i in range(n):\n        ys.append(y(i, n, a, b, c))\n    \n    return ys\n`)),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},\"speed can be improved further by disabling bound checking(@cython.boundscheck(False)) and negative indexing(@cython.wraparound(False)) \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/userguide/source_files_and_compilation.html#compiler-directives\"}),\"compiler directive instructions\"),\".\")),mdx(\"p\",null,\"Check the annotations for the Cython code, most of the yellow lines are now changed to white and only list operations are dark yellow because lists are Python objects. In a later section, we discuss optimizing lists using C arrays.\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"super-fast-python-cython/optimized_cython.jpg\",alt:\"Optimized Cython Annotation:=:70\"}))),mdx(\"p\",null,\"If we check the time for the optimized Cython code,\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`%%timeit -n 100\nn = 100000\nres = calculate_y_cython(n)\n\n\"\"\"Output:\n2.04 ms \\xB1 166 \\xB5s per loop (mean \\xB1 std. dev. of 7 runs, 100 loops each)\n\"\"\"\n`)),mdx(\"p\",null,\"it takes \",mdx(\"strong\",{parentName:\"p\"},\"0.002\"),\" seconds which is approximately \",mdx(\"strong\",{parentName:\"p\"},\"100x\"),\" times faster than the normal Python version that takes \",mdx(\"strong\",{parentName:\"p\"},\"0.19\"),\" seconds. By adding only static type and some tweaks, we made Python 100x faster. The powers of Cython are not limited to only static typing. We can further speed up the code with Numpy.\"),mdx(\"hr\",null),mdx(\"h2\",null,\"1000x times faster with MemoryView and Numpy\"),mdx(\"p\",null,\"In the Cython annotation snippet above, we see that the list operations of \",mdx(\"strong\",{parentName:\"p\"},\"ys\"),\" are still yellow as \",mdx(\"em\",{parentName:\"p\"},\"list()\"),\" is a python object and Cython cannot optimize Python objects interaction. \"),mdx(\"p\",null,\"To solve this, we can convert the list type to \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/tutorial/array.html\"}),\"memoryview arrays\"),\", and operations like \",mdx(\"em\",{parentName:\"p\"},\"append()\"),\" to indexing just like looping in C.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python:calculate_y_cython.pyx\"}),`cimport cython\nimport numpy as np\ncimport numpy as np\n\nctypedef long int li\nctypedef long long int lli\n\n@cython.boundscheck(False)  # Deactivate bounds checking\n@cython.wraparound(False)   # Deactivate negative indexing\ncdef lli fx(li x, int a, int b, int c):\n    cdef int d = (a + b) * c\n    return a*x + b*(x**2) + c*(x**3) + d\n\n@cython.boundscheck(False)\n@cython.wraparound(False)\ncdef double y(li x, li n, int a, int b, int c):\n    cdef:\n        lli af = fx(x, a, b, c)**2\n        li k = abs(n//2 - x)\n        lli bf = fx(k, a, b, c)\n    return (af-bf)/(n-1 + 1e-12)\n\n@cython.boundscheck(False)\n@cython.wraparound(False)\ncpdef calculate_y_cython(li n):\n    cdef double[:] ys = np.empty(n, dtype=np.float64)\n    cdef:\n        int a = 2, b = 5, c = -4\n        li i = 0\n    for i in range(n):\n        ys[i] = y(i, n, a, b, c)\n    return ys\n`)),mdx(\"p\",null,\"Before building the object code, we need to change \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cython.readthedocs.io/en/stable/src/tutorial/numpy.html\"}),\"build instructions to link Numpy\"),\" as a dependency like following\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python:setup.py\"}),`from distutils.core import setup\nfrom distutils.extension import Extension\nfrom Cython.Build import cythonize\nimport numpy\n\next_modules = [\n    Extension(\"calculate_y_function\",\n              sources=[\"calculate_y_cython.pyx\"],\n              libraries=[\"m\"],\n              compiler_directives={\"language_level\": \"3\"},\n              )\n]\n\nsetup(name=\"calculate Y function\",\n      ext_modules=cythonize(ext_modules),\n      include_dirs=[numpy.get_include()])\n`)),mdx(\"p\",null,\"The parameter \",mdx(\"em\",{parentName:\"p\"},\"include_dirs\"),\" includes external libraries like Numpy here.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"language-python\"}),`%%timeit -n 1000\nn = 100000\nres = calculate_y_cython(n)\n\n\"\"\"Output:\n208 \\xB5s \\xB1 11.3 \\xB5s per loop (mean \\xB1 std. dev. of 7 runs, 1000 loops each)\n\"\"\"\n`)),mdx(\"p\",null,\"The fully optimized version of Cython runs at \",mdx(\"strong\",{parentName:\"p\"},\"0.0002\"),\" seconds which is approximately \",mdx(\"strong\",{parentName:\"p\"},\"1000x\"),\" faster than the normal Python code. \"),mdx(\"p\",null,\"The usage of Numpy and MemoryViews in Cython needs separate discussion and I will write about Classes, C-math, Numpy, MemoryViews, and OpenMP in the Advanced Cython series later.\"),mdx(\"hr\",null),mdx(\"p\",null,\"Cython is a very powerful extension that we can use to speed up Python code. Sometimes it may not be possible to convert Python objects straight away like dictionaries (use C++ maps), so it's better to use Cython for repetitive tasks like loops, general functions with simple statements (like declaration and usage only), and math operations.\"),mdx(\"p\",null,\"Learn more about Cython by referencing\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"http://blog.behnel.de/posts/tuning-basic-object-operations-in-cython.html\"}),`Speeding up basic object operations in Cython\n`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.infoworld.com/article/3648539/faster-python-made-easier-with-cythons-pure-python-mode.html\"}),\"Faster Python made easier with Cython\\u2019s pure Python mode\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.peterbaumgartner.com/blog/intro-to-just-enough-cython-to-be-useful/\"}),\"An Introduction to Just Enough Cython to be Useful\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://nicolas-hug.com/blog/cython_notes\"}),\"Cython notes and tips\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"https://github.com/cython/cython/issues/3974\"}),\"(Github Issue) Improve cython interface with a more user-friendly compiling interface\"))))}MDXContent.isMDXComponent=!0;\n","scope":{}},"id":"super-fast-python-cython"},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"super-fast-python-cython"},"buildId":"jBc4UZUL4xIRAkt3gOT-Q","runtimeConfig":{},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>