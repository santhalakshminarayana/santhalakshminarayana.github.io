<!DOCTYPE html><html lang="en"><head><link href="https://fonts.googleapis.com/css2?family=Maven+Pro&amp;family=Share+Tech+Mono&amp;family=Source+Sans+Pro&amp;family=Ubuntu&amp;display=swap" rel="stylesheet" data-next-head=""/><meta charSet="utf-8" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="description" content="Improve MySQL performance in production by configuring various optimization techniques and tuning InnoDB settings." class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="author" content="Santha Lakshmi Narayana" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="keywords" content="mysql,mysql-performance-optimization,speed-up-mysql,innodb-performance-configuration,mysql-tuning" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta property="og:title" content="MySQL performance optimization techniques- Santha Lakshmi Narayana" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta property="og:description" content="Improve MySQL performance in production by configuring various optimization techniques and tuning InnoDB settings." class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta property="og:url" content="https://santhalakshminarayana.github.io/blog/mysql-performance-optimization-techniques" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta property="og:image" content="https://santhalakshminarayana.github.io/images/mysql-performance-optimization-techniques/mysql-performance-optimization-techniques.jpg" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta property="og:type" content="article" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta property="og:article:publisher" content="https://santhalakshminarayana.github.io/" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta property="og:site_name" content="Santha Lakshmi Narayana" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="twitter:card" content="summary_large_image" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="twitter:title" content="MySQL performance optimization techniques- Santha Lakshmi Narayana" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="twitter:description" content="Improve MySQL performance in production by configuring various optimization techniques and tuning InnoDB settings." class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="twitter:url" content="https://santhalakshminarayana.github.io/blog/mysql-performance-optimization-techniques" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="twitter:site" content="@santhalakshminarayana" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="twitter:image" content="https://santhalakshminarayana.github.io/images/mysql-performance-optimization-techniques/mysql-performance-optimization-techniques.jpg" class="jsx-19bb03d26fbdbce5" data-next-head=""/><meta name="twitter:creator" content="@santhalakshminarayana" class="jsx-19bb03d26fbdbce5" data-next-head=""/><link rel="icon" href="/images/santha-lakshmi-narayana-logo.png?" class="jsx-19bb03d26fbdbce5" data-next-head=""/><link rel="canonical" href="https://santhalakshminarayana.github.io/blog/mysql-performance-optimization-techniques" class="jsx-19bb03d26fbdbce5" data-next-head=""/><title class="jsx-19bb03d26fbdbce5" data-next-head="">MySQL performance optimization techniques- Santha Lakshmi Narayana</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous" class="jsx-19bb03d26fbdbce5" data-next-head=""/><link rel="preload" href="/_next/static/chunks/041cc2866dda2e3a.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/041cc2866dda2e3a.css" data-n-g=""/><link rel="preload" href="/_next/static/chunks/3fe256a18a997e71.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/3fe256a18a997e71.css" data-n-p=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/ef5d76c93924b3ac.js" defer=""></script><script src="/_next/static/chunks/a7a0d91b4e2f758c.js" defer=""></script><script src="/_next/static/chunks/73033f4a54aa0849.js" defer=""></script><script src="/_next/static/chunks/204e2614e99eb52b.js" defer=""></script><script src="/_next/static/chunks/turbopack-a16f5722303d41f8.js" defer=""></script><script src="/_next/static/chunks/7d576baa31dcb5b4.js" defer=""></script><script src="/_next/static/chunks/16fc2617007832ca.js" defer=""></script><script src="/_next/static/chunks/1197a2b6b171f803.js" defer=""></script><script src="/_next/static/chunks/ec1db6b7d5534f1f.js" defer=""></script><script src="/_next/static/chunks/turbopack-35f446bca4fe2f15.js" defer=""></script><script src="/_next/static/IVVkt6-z9PpDoTmC5If8f/_ssgManifest.js" defer=""></script><script src="/_next/static/IVVkt6-z9PpDoTmC5If8f/_buildManifest.js" defer=""></script><style id="__jsx-870580ea71b30c5e">.img-text.jsx-870580ea71b30c5e{text-align:center;color:#1d2b35;overflow-wrap:"break-word";font-family:Source Sans Pro,sans-serif;font-size:calc(.8rem + .1vw);display:block}a.jsx-870580ea71b30c5e{color:#1d2b35;border-bottom:1px solid;margin:0;text-decoration:none}</style><style id="__jsx-231957775">.file-name-container.jsx-231957775{background-color:#1d2b35d9;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:break-word;border-top-left-radius:5px;border-top-right-radius:5px;width:100%;max-width:100%;margin-top:1vh;padding:calc(.5rem + .2vw);display:flex}.file-name.jsx-231957775{color:#fffecbf2;font-family:Share Tech Mono,monospace;font-size:calc(.9rem + .1vw)}</style><style id="__jsx-1618327763">.footer-container.jsx-1618327763{background:#1d2b35e6;padding:1vw 1vw 1vw 1vw;flex-direction:column;display:flex}.footer-container-links.jsx-1618327763{flex-direction:row;justify-content:center;display:flex}.footer-links.jsx-1618327763{justify-content:center;align-items:center;display:flex}.link-item.jsx-1618327763{margin:0 1vw 0 1vw}.link.jsx-1618327763{cursor:pointer: background-color: yellow;text-decoration:none}.link.jsx-1618327763:hover{color:#000}.copy-right-container.jsx-1618327763{flex-direction:row;justify-content:center;margin-top:10px;display:flex}.copy-right-text.jsx-1618327763{color:#fffecb;font-family:Maven Pro,sans-serif;font-size:calc(.75rem + .1vw)}</style><style id="__jsx-19bb03d26fbdbce5">.blog-content.jsx-19bb03d26fbdbce5{flex-direction:column;flex:100%;width:50vw;max-width:50vw;min-height:90vh;margin:1vw 25vw;display:flex}@media screen and (width<=980px){.blog-content.jsx-19bb03d26fbdbce5{width:70vw;max-width:70vw;margin:1vw 15vw}}@media screen and (width<=760px){.blog-content.jsx-19bb03d26fbdbce5{width:90vw;max-width:90vw;margin:1vw 5vw}}</style></head><body><div id="__next"><div style="min-height:100vh" class="jsx-19bb03d26fbdbce5"><div style="background:#1d2b35"><div class="Header-module__vcZAwq__headerContainer"><div class="Header-module__vcZAwq__headerLeft"><a href="/"><img src="/images/santha-lakshmi-narayana-logo.png" alt="Logo" class="Header-module__vcZAwq__logo"/></a><a class="Header-module__vcZAwq__headerLeftLink Header-module__vcZAwq__name" style="color:#ffaa33" href="/"><b>Santha Lakshmi Narayana</b></a></div><div class="Header-module__vcZAwq__headerRight"><a class="Header-module__vcZAwq__headerRightLink" style="color:#ffaa33" href="/about">About</a><a href="#" class="Header-module__vcZAwq__headerRightLink" style="color:#ffaa33">Tags</a><a class="Header-module__vcZAwq__headerRightLink" style="color:#ffaa33" href="/">Home</a></div></div><div style="display:none"><div class="Tags-module__ba7cKq__tags" style="background-color:#fffecb;border-bottom:5px solid #071013"><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/ai">#ai</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/system-design">#system-design</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/python">#python</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/python-performance">#python-performance</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/go">#go</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/linux">#linux</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/mysql">#mysql</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/image-processing">#image-processing</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/opencv">#opencv</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/concurrency">#concurrency</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/color-science">#color-science</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/react">#react</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/next-js">#next-js</a><a class="Tags-module__ba7cKq__tagLink" style="color:#1d2b35;border-bottom-color:#fb232e" href="/tags/flutter">#flutter</a></div></div></div><article class="jsx-19bb03d26fbdbce5 blog-content"><p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><picture class="jsx-870580ea71b30c5e"><img src="/images/mysql-performance-optimization-techniques/mysql-performance-optimization-techniques.jpg" alt="MySQl performance optimization techniques" style="width:100%;max-width:100%;height:auto;margin-left:0%" class="jsx-870580ea71b30c5e"/><span class="jsx-870580ea71b30c5e img-text"></span></picture></p>
<h6 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#fb232e;margin:1vh 0 1vh 0;overflow-wrap:break-word">Published on: <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Nov 10, 2024</strong></h6>
<h1 style="font-family:&#x27;Ubuntu&#x27;, sans-serif;font-size:calc(1rem + 1.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">MySQL performance optimization techniques</h1>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">MySQL is the top 2 most used RDBMS for production. It scales well vertically for small-medium-size databases. The default configuration that MySQL comes with works well for only the initial stages of deployment. For deploying in production, the default settings must be tuned for better performance. Other than the parameters/settings, we also need to take care of how we handle/interact with the MySQL like query optimization, indexes, connection pool, etc.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">This blog goes through some of the most important configurations that need to be looked at, which improve MySQL performance by multiplefold with fewer settings.</p>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">DB size</h3>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">First, check the total DB data size to better understand the type of improvements and tuning to apply to various parameters.</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>total DB size (both data and index size):</li>
</ul>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>SELECT ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS &quot;Size (MB)&quot; 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>FROM information_schema.TABLES;
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span></code></pre></pre>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>by each database:</li>
</ul>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>SELECT table_schema AS &quot;Database&quot;, ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS &quot;Size (MB)&quot; 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>FROM information_schema.TABLES 
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>GROUP BY table_schema;
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span></code></pre></pre>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>by table in <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">database_name</strong>:</li>
</ul>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>SELECT table_name AS &quot;Table&quot;, ROUND(((data_length + index_length) / 1024/ 1024), 2) AS &quot;Size (MB)&quot; 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>FROM information_schema.TABLES 
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>WHERE table_schema = &quot;database_name&quot; 
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span>ORDER BY (data_length + index_length) DESC;
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">5</span></code></pre></pre>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">InnoDB Architecture</h2>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">It is crucial to understand the InnoDB architecture and how it saves data into memory because configuring InnoDB related parameters like <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">innodb_buffer_pool_size</em> results in boosted performance. The high-level architectural components of InnoDB we are interested in are:</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>Tablespace &amp; Data Pages</li>
<li>InnoDB buffer pool</li>
<li>Dublewrite buffer</li>
<li>Undo Log</li>
<li>Redo Log</li>
</ul>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><picture class="jsx-870580ea71b30c5e"><img src="/images/mysql-performance-optimization-techniques/innodb-architecture.png" alt="InnoDB Architecture" style="width:60%;max-width:60%;height:auto;margin-left:20%" class="jsx-870580ea71b30c5e"/><span class="jsx-870580ea71b30c5e img-text"><a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-architecture.html" target="_blank" rel="noreferrer" class="jsx-870580ea71b30c5e">InnoDB Architecture</a></span></picture></p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Data is stored in tables as data pages under tablespace generally with a file-per-table mode in harddisk. Reading the pages from the disk for every operation adds latency and MySQL can&#x27;t serve multiple requests concurrently. So, InnoDB reads the data pages and loads them into a buffer in memory (RAM) for fast access called <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Buffer Pool</strong>. The larger the buffer pool size, the more read hits the InnoDB can get from this buffer cache. So, it is crucial to allocate more buffer pool memory. Generally, <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">50-75%</strong> of memory is recommended to allocate for the buffer pool. InnoDB first checks if the data page is available in the buffer pool, if not it loads them to memory. To clean up the space for newer pages, InnoDB removes the pages based on the LRU method.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The buffer pool is all about optimizing reads faster. If any write happens to those pages in the memory, instead of writing them directly to the disk, changes happen to the pages in the buffer pool itself. This is to save the time for I/O operations.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Regarding writes, any write operation is first recorded in the <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Redo Log</strong> buffer as <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Write-ahead Log</strong> for recovery and backup purposes. After writing to the log buffer has become a success then only the transactions happen to the data pages in the buffer pool. So, when the crash happens, InnoDB can redo the un-committed transactions by reading through these Redo Logs. Logs are stored in the buffer and later flushed to disk.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Any transaction writes are first stored in <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Undo Log</strong> where it stores the before-data of the affected rows of the transactions. This is also used for transaction rollback or crash recovery when the system crashes while performing any transactions or simply to undo the transaction changes. When multiple connections read the same data that another connection is locked in, they all see the before data stored in the undo logs.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Data pages in the buffer that are changing due to transactions are called <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Dirty Pages</strong> and are flushed to actual disk storage later when the checkpoint happens. InnoDB uses fuzzy checkpoints rather than static/fixed checkpoint intervals to flush the pages. Fuzzy checkpoint means instead of stopping the new transactions record for flushing the data synchronously, analyze and find the dirty pages and flush them asynchronously in the background without stopping new transactions.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">For recovery purposes, data is first synced to <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Doublewrite buffer</strong> in the disk and then directly in tablespace files. This is because, after the crash, InnoDB checks the data in this double-write buffer and the actual data, and syncs them by each page. The operations needed to perform for actual data sync are more than simply writing the pages to the double-write buffer. So, it is faster and the pages are flushed to buffer in batches rather than file-by-file.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Ref</strong>:</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>https://www.alibabacloud.com/blog/mysql-memory-allocation-and-management-part-ii_600992</li>
<li>https://hidetatz.medium.com/how-innodb-writes-data-on-the-disk-1b109a8a8d14</li>
<li>https://www.percona.com/blog/understanding-the-differences-between-innodb-undo-log-and-redo-log/</li>
<li>https://www.alibabacloud.com/blog/what-are-the-differences-and-functions-of-the-redo-log-undo-log-and-binlog-in-mysql_598035</li>
</ul>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Innodb buffer pool hit ratio check</h3>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Show InnoDB buffer present config</p>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>SHOW engine innodb status;
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span></code></pre></pre>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Get buffer pool size(bytes)</p>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>SELECT ROUND(@@innodb_buffer_pool_size / 1024 / 1024 / 1024, 2) AS &quot;Buffer pool size (GB)&quot;;
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span></code></pre></pre>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Get pages read and read requests from the buffer pool</p>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>SELECT variable_name, variable_value from sys.metrics 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>WHERE variable_name IN (&#x27;innodb_pages_read&#x27;, &#x27;innodb_buffer_pool_read_requests&#x27;);
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span></code></pre></pre>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mi>i</mi><mi>t</mi><mtext>–</mtext><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo>=</mo><mn>100</mn><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>i</mi><mi>n</mi><mi>n</mi><mi>o</mi><mi>d</mi><mi>b</mi><mi mathvariant="normal">_</mi><mi>p</mi><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow><mrow><mi>i</mi><mi>n</mi><mi>n</mi><mi>o</mi><mi>d</mi><mi>b</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>r</mi><mi mathvariant="normal">_</mi><mi>p</mi><mi>o</mi><mi>o</mi><mi>l</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>s</mi></mrow></mfrac><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Hit\text{\textendash}Ratio=100 \times (1 - (\frac{innodb\_pages\_read}{innodb\_buffer\_pool\_read\_requests}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord text"><span class="mord">–</span></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">100</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.3904em;vertical-align:-0.996em"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3944em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">inn</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">b</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">b</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord mathnormal" style="margin-right:0.02778em">er</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">p</span><span class="mord mathnormal">oo</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mord mathnormal">u</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.7em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">inn</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">b</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">es</span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.996em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">))</span></span></span></span></span>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">If the hit ratio is not close to <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">100%</strong> then increase the buffer pool size to allow the maximum DB data to fit but within memory requirements.</p>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Query optimization</h3>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Use <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">explain</strong>, <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">analyze</strong>, and <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">format</strong>=<!-- --> to analyze the query breakdown steps, indexes used, and operations performed to get a hold on where we can improve the query processing by adding necessary indexes, dropping unnecessary conditions, re-ordering query steps, and other bottleneck steps.</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>Check the query optimization plan</li>
<li>Add indexes like composite index and covering index to completely cover all columns in the query for super fast lookup</li>
<li>Re-write query as a <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">SARGABLE</strong>(Search ARGument ABLE) query which utilizes the index for quick searching instead of working on each row</li>
<li>Avoid functions and calculations on index columns in the query as these will apply for each row</li>
<li>For function-based where clause, create a function-based index on the column</li>
<li>Limit the amount of data rows that need to be sorted by better query execution planning</li>
<li>Rewrite JOINs into a subqueries sometimes gives better results</li>
<li>Order of execution: FROM, JOIN, WHERE, GROUP BY, HAVING, SELECT, ORDER BY, LIMIT</li>
</ul>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Indexes in MySQL</h3>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Every table should have a primary key. If a primary key is not defined, then InnoDB uses the first unique non-null column as the primary key. If no such column exists, InnoDB creates a hidden row incremental key for the primary key.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Some of the trade-offs to consider are</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>Sequential vs Non-sequential primary key</li>
<li>Clustered vs Non-clustered index</li>
<li>Single-level index vs Composite indexes (and Covering index)</li>
<li>Single-level index vs Column order index</li>
</ul>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">If there are redundant indexes, then write operations takes time, check and remove the redundant indexes</p>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>select * from sys.schema_redundant_indexes;
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span></code></pre></pre>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Also, check how much memory an index takes, and if it is not in acceptable levels, drop that index and change the schema for better performance.</p>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Connection Pool</h2>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>A DB connection comprises opening the tcp socket, acknowledgement, authentication, authorization, network session creation, etc. So, it takes time to open a new connection every time. So maintain a pool of connections to re-use.</li>
<li>By default, the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_open_connections</em> a MySQL server can handle is 150, but can be set up to 2^32 (but up to 100,000 should be the limit generally).</li>
<li>Types of connection pooling:<!-- -->
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>Session: Maintain connection until the session completes. The client can make any number of transactions until connection timeout is reached.</li>
<li>Transaction: Connection is returned to the pool when the transaction completes.</li>
<li>Statement: A connection is used only for a single SQL statement.</li>
</ul>
</li>
<li>Generally, <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_pool_size</em> (<em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_active_connections</em>) is set to (2 or 4 * no.of cores), but it varies depending on the type of application and the traffic.</li>
<li>For normal setup, <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_idle_connections</em> (ex: 80) will be less than <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_pool_size</em> (ex: 100, and 20 connections will be closed after use as the max idle connections are 80).</li>
<li>For high concurrent systems, set the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_idle_connections</em> the same as the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_pool_size</em>, idle connections take some memory but it&#x27;s a trade-off compared to the overhead of opening connections for highly frequent requests.</li>
</ul>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Scaling challenges</h3>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>Max open connections, idle connections, and pool size should be limited considering the system resources limit.</li>
<li>System resources like memory, CPU cache, and data storage are required if there are more connections opened at a time. If the system can&#x27;t handle more connections, all operations will be rejected and that leads to data inconsistency.</li>
<li>In Linux servers, the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">ulimit</em> restricts the max open file descriptors.</li>
<li>MySQL is multi-threaded and allocates one thread per connection which requires thread management overhead along with system resources.</li>
<li>Configuration variables like <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">thread_cache_size</em> (<!-- --> defaults to 8-100, and multiplexed to cores) which defines how many threads can be cached for re-use when the client disconnects. This also requires additional memory but improves performance.</li>
<li>MySQL creates a THD (Thread Handle Descriptor) for each connection with a minimum memory of ~10KB and can grow to ~10MB for average connection when executing queries. So, handling huge no.of parallel connections requires huge memory requirements and also high thrashing.</li>
<li>As more no.of connections increases but the max_connections are set in limit which are nothing but user threads, there has to be a balance between the user thread-per-core ratio (max ratio recommended is ~4) and the latency. So, based on this, the transactions-per-second (TPS) the server can handle can be determined, and has to scale the DB for the expected load.</li>
<li>Another important challenge is the underlying disk storage. If there is huge data stored, the user threads spend most of the time for data to arrive from disk. So, better disk storage mechanism has to be considered like SSDs, cache, read/write heavy disks, etc.</li>
<li>In MySQL thread pool (enterprise edition), correctly tuning the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">thread_pool_size</em> and <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_transaction_limit</em> for high concurrency is very difficult but it&#x27;s better than the default thread handling mechanism.</li>
</ul>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Ref</strong>:</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>https://dev.mysql.com/blog-archive/mysql-connection-handling-and-scaling/</li>
<li>https://dev.mysql.com/blog-archive/the-new-mysql-thread-pool/</li>
<li>https://dev.to/dbvismarketing/a-guide-to-multithreading-in-sql-3hh1</li>
</ul>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">Transactions Isolation</h2>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">In high concurrent transaction systems, it is important to isolate the transactions for data consistency. so, when multiple connections try to change the same data, how can transaction isolation be maintained so that the following problems can be avoided?</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Dirty Reads</strong>: A query in a transaction may return inconsistent data due to uncommitted changes in other transactions.</li>
<li><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Non-repeatable Reads</strong>: The same query in a transaction reads different data rows if executed multiple times. This may happen due to other transactions committed to the changes.</li>
<li><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Phantom Reads</strong>: The data rows returned by the select statements differ within the same transaction as another transaction might have inserted new rows.</li>
</ul>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">The following isolation levels can be set in MySQL for transaction isolation:</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Read Uncommitted</strong>: Transactions see other transactions&#x27; un-committed changes that may cause data inconsistencies. Suitable for highly frequent updates where accuracy/consistency is not critical. Ex: Dashboards, Analytics. Solves: None</li>
<li><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Read Committed</strong>: Transactions see other transactions changes only if they are committed. Consistent data but anything can happen between transactions. Suitable for both highly frequent and data-consistent scenarios. Ex: Banking, reservations. Solves: Dirty Reads.</li>
<li><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Repeatable Read</strong>: A transaction sees the same snapshot of data throughout the life cycle and is unaffected by other transactions. Default in MySQL with InnoDB&#x27;s MVCC(Multi-Version Concurrency Control). Suitable for data-consistent systems where performance can be compromised. Ex: General Web services. Solves Dirty Reads, Non-Repeatable Reads</li>
<li><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Serialization</strong>: Transactions lock the rows restricting other transactions to wait until completion. Suitable for high data consistent systems. Ex: Financial services. Solves: Dirty Reads, Non-repeatable Reads, Phantom Reads.</li>
</ul>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">So, based on the type of requirements, set the isolation level for high concurrent database transactions.</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Ref</strong>:</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>https://planetscale.com/blog/mysql-isolation-levels-and-how-they-work</li>
<li>https://dev.to/eyo000000/a-straightforward-guide-for-mysql-locks-56i1</li>
<li>https://simon-ninon.medium.com/dont-break-production-learn-about-mysql-locks-297671ec8e73</li>
</ul>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h2 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 1vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">MySQL Monitoring</h2>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">MySQL can handle high concurrent traffic with a single instance if it is deployed with high CPU cores, fast access storage (SSD), and high RAM. Some of the variables to look out for monitoring are</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>max_connections</li>
<li>table_open_cache</li>
<li>threads_connected</li>
<li>threads_running</li>
<li>thread_cache_size</li>
<li>innodb_buffer_pool_size</li>
</ul>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Also, monitor the status variables like</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>Com_select, Com_insert, Com_update, Com_delete</li>
<li>status_queries</li>
<li>max_used_connections</li>
</ul>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Check the reads and writes for a table with index used or not. Read count increases even without any operations also due to various reasons like background processes, cache eviction, etc., So these are not very accurate but give the proportion of operations that MySQL performs.</p>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>select object_schema, object_name, count_read, count_write, index_name 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span>from performance_schema.table_io_waits_summary_by_index_usage 
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">3</span>order by count_read+count_write desc limit 5;
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">4</span></code></pre></pre>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Check the max percentage of concurrent connections at a time relative to max connections. If the value touches &gt;95%, then increase the max_connections value.</p>
<pre><pre class="language-text" style="color:#d4d4d4;font-size:calc(0.9rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#1e1e1e;background-color:#071013f2;padding-bottom:1vh;margin-top:1vh;margin-bottom:1vh;border-radius:5px"><code class="language-text" style="white-space:pre;color:#d4d4d4;font-size:calc(0.8rem + 0.1vw);text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.2;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">1</span><span>100 * threads_connected / max_connections
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:#6a9955">2</span></code></pre></pre>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Tune the following for better performance</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>Increase the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">max_connections</em> and <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">thread_cache_size</em> for handling high concurrent connections with reuse.</li>
<li>Increase the <em style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;background-color:#07101326;color:#071013f2;margin:0vh 0 1vh 0;padding:0 2px 0 2px;border-radius:2px">innodb_buffer_pool_size</em> for more cached data and less time for the server to read from the disk.</li>
<li>Monitor the <strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">p99</strong> which measures the latency of 99% of all transactions and check if that latency is within the defined limits.</li>
</ul>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;margin:1vh 0 1vh 0;overflow-wrap:break-word" id="">MySQL configuration parameters</h3>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Having discussed the various topics and internals of MySQL, the following are some of the important parameters that affect the MySQL performance. As the list is very large, I have just mentioned the names and they require separate discussion deeply.</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>default-character-set = utf8mb4</li>
<li>max_connections</li>
<li>max_user_connections, max_allowed_packet, for limiting DDoS attacks</li>
<li>innodb_change_buffering</li>
<li>innodb_buffer_pool_size</li>
<li>innodb_buffer_pool_instances, if innodb_buffer_pool_size is more than 1GB set multiple instances</li>
<li>innodb_lru_scan_depth</li>
<li>innodb_io_capacity, innodb_io_capacity_max</li>
<li>innodb_max_dirty_pages_pct</li>
<li>innodb_flush_neighbors</li>
<li>innodb_read_io_threads, innodb_write_io_threads</li>
<li>innodb_flush_log_at_trx_commit, 1 is the default for ACID compliance. 0 or 2 for fast writes. For master keep it as 1.</li>
<li>innodb_log_buffer_size</li>
<li>innodb_log_file_size, innodb_log_files_in_group, increase these for write-heavy, for read-heavy these are not important</li>
<li>innodb_flush_method, for SSD set value as O_DIRECT</li>
<li>innodb_adaptive_flushing</li>
<li>innodb_stats_on_metadata</li>
<li>innodb_doublewrite</li>
<li>innodb_purge_threads</li>
<li>innodb_thread_concurrency</li>
<li>innodb_parallel_read_threads</li>
<li>thread_cache_size</li>
<li>have_query_cache, disable for read-heavy production</li>
<li>wait_timeout, interactive_timeout</li>
<li>sort_buffer_size, read_rnd_buffer_size, join_buffer_size</li>
<li>performance_schema, disable if not needed</li>
<li>max_prepared_stmt_count, restrict to limit memory leaks</li>
<li>tmp_table_size, max_heap_table_size</li>
<li>table_open_cache, should be higher than opened_tables</li>
<li>table_open_cache_instances, table_definition_cache</li>
<li>slow_query_log, log_query_time</li>
</ul>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">For better performance, monitor the following things continuously</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>QPS (queries per second) under load</li>
<li>Max concurrent connections at peak</li>
<li>Read/write ratio to enhance the performance by replicas/partitions</li>
<li>Buffer pool hit ratio</li>
<li>No.of I/O operations under load</li>
<li>CPU load with I/O wait time</li>
<li>p99 or p95 latency</li>
</ul>
<hr style="margin:2vh 25% 2vh 25%;border:1px solid #07101380"/>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word"><strong style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);font-style:normal;font-weight:bold;color:#1d2b35f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">Ref</strong>:</p>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>https://github.com/major/MySQLTuner-perl/blob/master/INTERNALS.md</li>
<li>https://www.percona.com/blog/mysql-101-parameters-to-tune-for-mysql-performance/</li>
<li>https://www.woktron.com/secure/knowledgebase/272/How-to-optimize-MySQL-performance.html</li>
<li>https://www.red-gate.com/simple-talk/databases/mysql/optimizing-my-cnf-for-mysql-performance/</li>
<li>https://releem.com/docs/mysql-performance-parameters</li>
<li>https://blog.searce.com/fewer-cpu-cores-will-blockyour-database-iops-in-gcp-b817b8cb8af2</li>
<li>https://blog.searce.com/how-max-prepared-stmt-count-bring-down-the-production-mysql-system-6ca28e577663</li>
<li>https://tanishiking24.hatenablog.com/entry/innodb-durability</li>
</ul></article><div class="jsx-1618327763 footer-container"><div class="jsx-1618327763 footer-container-links"><div class="jsx-1618327763 footer-links"><div class="jsx-1618327763 link-item"><a href="https://github.com/santhalakshminarayana" rel="noreferrer" target=" _blank" class="jsx-1618327763 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div></a></div><div class="jsx-1618327763 link-item"><a href="https://www.linkedin.com/in/santhalakshminarayana/" rel="noreferrer" target="_blank" class="jsx-1618327763 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></div></a></div></div></div><div class="jsx-1618327763 copy-right-container"><p class="jsx-1618327763 copy-right-text">Santha Lakshmi Narayana © 2026</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postMetadata":{"title":"MySQL performance optimization techniques","description":"Improve MySQL performance in production by configuring various optimization techniques and tuning InnoDB settings.","imgName":"mysql-performance-optimization-techniques/mysql-performance-optimization-techniques.jpg","date":"Nov 10, 2024","tags":["mysql","system-design"],"keywords":["mysql","mysql-performance-optimization","speed-up-mysql","innodb-performance-configuration","mysql-tuning"],"id":"mysql-performance-optimization-techniques"},"postContent":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    annotation: \"annotation\",\n    code: \"code\",\n    em: \"em\",\n    h1: \"h1\",\n    h2: \"h2\",\n    h3: \"h3\",\n    h6: \"h6\",\n    hr: \"hr\",\n    img: \"img\",\n    li: \"li\",\n    math: \"math\",\n    mfrac: \"mfrac\",\n    mi: \"mi\",\n    mn: \"mn\",\n    mo: \"mo\",\n    mrow: \"mrow\",\n    mtext: \"mtext\",\n    p: \"p\",\n    pre: \"pre\",\n    semantics: \"semantics\",\n    span: \"span\",\n    strong: \"strong\",\n    ul: \"ul\",\n    ..._provideComponents(),\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"mysql-performance-optimization-techniques/mysql-performance-optimization-techniques.jpg\",\n        alt: \"MySQl performance optimization techniques\"\n      })\n    }), \"\\n\", _jsxs(_components.h6, {\n      children: [\"Published on: \", _jsx(_components.strong, {\n        children: \"Nov 10, 2024\"\n      })]\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"MySQL performance optimization techniques\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"MySQL is the top 2 most used RDBMS for production. It scales well vertically for small-medium-size databases. The default configuration that MySQL comes with works well for only the initial stages of deployment. For deploying in production, the default settings must be tuned for better performance. Other than the parameters/settings, we also need to take care of how we handle/interact with the MySQL like query optimization, indexes, connection pool, etc.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This blog goes through some of the most important configurations that need to be looked at, which improve MySQL performance by multiplefold with fewer settings.\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      children: \"DB size\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"First, check the total DB data size to better understand the type of improvements and tuning to apply to various parameters.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"total DB size (both data and index size):\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"SELECT ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS \\\"Size (MB)\\\" \\nFROM information_schema.TABLES;\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"by each database:\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"SELECT table_schema AS \\\"Database\\\", ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS \\\"Size (MB)\\\" \\nFROM information_schema.TABLES \\nGROUP BY table_schema;\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"by table in \", _jsx(_components.strong, {\n          children: \"database_name\"\n        }), \":\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"SELECT table_name AS \\\"Table\\\", ROUND(((data_length + index_length) / 1024/ 1024), 2) AS \\\"Size (MB)\\\" \\nFROM information_schema.TABLES \\nWHERE table_schema = \\\"database_name\\\" \\nORDER BY (data_length + index_length) DESC;\\n\"\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h2, {\n      children: \"InnoDB Architecture\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"It is crucial to understand the InnoDB architecture and how it saves data into memory because configuring InnoDB related parameters like \", _jsx(_components.em, {\n        children: \"innodb_buffer_pool_size\"\n      }), \" results in boosted performance. The high-level architectural components of InnoDB we are interested in are:\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Tablespace \u0026 Data Pages\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"InnoDB buffer pool\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Dublewrite buffer\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Undo Log\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Redo Log\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"mysql-performance-optimization-techniques/innodb-architecture.png\",\n        alt: \"InnoDB Architecture:=:60:=:InnoDB Architecture$$$https://dev.mysql.com/doc/refman/8.4/en/innodb-architecture.html\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Data is stored in tables as data pages under tablespace generally with a file-per-table mode in harddisk. Reading the pages from the disk for every operation adds latency and MySQL can't serve multiple requests concurrently. So, InnoDB reads the data pages and loads them into a buffer in memory (RAM) for fast access called \", _jsx(_components.strong, {\n        children: \"Buffer Pool\"\n      }), \". The larger the buffer pool size, the more read hits the InnoDB can get from this buffer cache. So, it is crucial to allocate more buffer pool memory. Generally, \", _jsx(_components.strong, {\n        children: \"50-75%\"\n      }), \" of memory is recommended to allocate for the buffer pool. InnoDB first checks if the data page is available in the buffer pool, if not it loads them to memory. To clean up the space for newer pages, InnoDB removes the pages based on the LRU method.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The buffer pool is all about optimizing reads faster. If any write happens to those pages in the memory, instead of writing them directly to the disk, changes happen to the pages in the buffer pool itself. This is to save the time for I/O operations.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Regarding writes, any write operation is first recorded in the \", _jsx(_components.strong, {\n        children: \"Redo Log\"\n      }), \" buffer as \", _jsx(_components.strong, {\n        children: \"Write-ahead Log\"\n      }), \" for recovery and backup purposes. After writing to the log buffer has become a success then only the transactions happen to the data pages in the buffer pool. So, when the crash happens, InnoDB can redo the un-committed transactions by reading through these Redo Logs. Logs are stored in the buffer and later flushed to disk.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Any transaction writes are first stored in \", _jsx(_components.strong, {\n        children: \"Undo Log\"\n      }), \" where it stores the before-data of the affected rows of the transactions. This is also used for transaction rollback or crash recovery when the system crashes while performing any transactions or simply to undo the transaction changes. When multiple connections read the same data that another connection is locked in, they all see the before data stored in the undo logs.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Data pages in the buffer that are changing due to transactions are called \", _jsx(_components.strong, {\n        children: \"Dirty Pages\"\n      }), \" and are flushed to actual disk storage later when the checkpoint happens. InnoDB uses fuzzy checkpoints rather than static/fixed checkpoint intervals to flush the pages. Fuzzy checkpoint means instead of stopping the new transactions record for flushing the data synchronously, analyze and find the dirty pages and flush them asynchronously in the background without stopping new transactions.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For recovery purposes, data is first synced to \", _jsx(_components.strong, {\n        children: \"Doublewrite buffer\"\n      }), \" in the disk and then directly in tablespace files. This is because, after the crash, InnoDB checks the data in this double-write buffer and the actual data, and syncs them by each page. The operations needed to perform for actual data sync are more than simply writing the pages to the double-write buffer. So, it is faster and the pages are flushed to buffer in batches rather than file-by-file.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Ref\"\n      }), \":\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"https://www.alibabacloud.com/blog/mysql-memory-allocation-and-management-part-ii_600992\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://hidetatz.medium.com/how-innodb-writes-data-on-the-disk-1b109a8a8d14\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://www.percona.com/blog/understanding-the-differences-between-innodb-undo-log-and-redo-log/\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://www.alibabacloud.com/blog/what-are-the-differences-and-functions-of-the-redo-log-undo-log-and-binlog-in-mysql_598035\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      children: \"Innodb buffer pool hit ratio check\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Show InnoDB buffer present config\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"SHOW engine innodb status;\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Get buffer pool size(bytes)\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"SELECT ROUND(@@innodb_buffer_pool_size / 1024 / 1024 / 1024, 2) AS \\\"Buffer pool size (GB)\\\";\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Get pages read and read requests from the buffer pool\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"SELECT variable_name, variable_value from sys.metrics \\nWHERE variable_name IN ('innodb_pages_read', 'innodb_buffer_pool_read_requests');\\n\"\n      })\n    }), \"\\n\", _jsx(_components.span, {\n      className: \"katex-display\",\n      children: _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            display: \"block\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsxs(_components.mrow, {\n                children: [_jsx(_components.mi, {\n                  children: \"H\"\n                }), _jsx(_components.mi, {\n                  children: \"i\"\n                }), _jsx(_components.mi, {\n                  children: \"t\"\n                }), _jsx(_components.mtext, {\n                  children: \"–\"\n                }), _jsx(_components.mi, {\n                  children: \"R\"\n                }), _jsx(_components.mi, {\n                  children: \"a\"\n                }), _jsx(_components.mi, {\n                  children: \"t\"\n                }), _jsx(_components.mi, {\n                  children: \"i\"\n                }), _jsx(_components.mi, {\n                  children: \"o\"\n                }), _jsx(_components.mo, {\n                  children: \"=\"\n                }), _jsx(_components.mn, {\n                  children: \"100\"\n                }), _jsx(_components.mo, {\n                  children: \"×\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsx(_components.mn, {\n                  children: \"1\"\n                }), _jsx(_components.mo, {\n                  children: \"−\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \"(\"\n                }), _jsxs(_components.mfrac, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      children: \"i\"\n                    }), _jsx(_components.mi, {\n                      children: \"n\"\n                    }), _jsx(_components.mi, {\n                      children: \"n\"\n                    }), _jsx(_components.mi, {\n                      children: \"o\"\n                    }), _jsx(_components.mi, {\n                      children: \"d\"\n                    }), _jsx(_components.mi, {\n                      children: \"b\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"_\"\n                    }), _jsx(_components.mi, {\n                      children: \"p\"\n                    }), _jsx(_components.mi, {\n                      children: \"a\"\n                    }), _jsx(_components.mi, {\n                      children: \"g\"\n                    }), _jsx(_components.mi, {\n                      children: \"e\"\n                    }), _jsx(_components.mi, {\n                      children: \"s\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"_\"\n                    }), _jsx(_components.mi, {\n                      children: \"r\"\n                    }), _jsx(_components.mi, {\n                      children: \"e\"\n                    }), _jsx(_components.mi, {\n                      children: \"a\"\n                    }), _jsx(_components.mi, {\n                      children: \"d\"\n                    })]\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      children: \"i\"\n                    }), _jsx(_components.mi, {\n                      children: \"n\"\n                    }), _jsx(_components.mi, {\n                      children: \"n\"\n                    }), _jsx(_components.mi, {\n                      children: \"o\"\n                    }), _jsx(_components.mi, {\n                      children: \"d\"\n                    }), _jsx(_components.mi, {\n                      children: \"b\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"_\"\n                    }), _jsx(_components.mi, {\n                      children: \"b\"\n                    }), _jsx(_components.mi, {\n                      children: \"u\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mi, {\n                      children: \"e\"\n                    }), _jsx(_components.mi, {\n                      children: \"r\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"_\"\n                    }), _jsx(_components.mi, {\n                      children: \"p\"\n                    }), _jsx(_components.mi, {\n                      children: \"o\"\n                    }), _jsx(_components.mi, {\n                      children: \"o\"\n                    }), _jsx(_components.mi, {\n                      children: \"l\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"_\"\n                    }), _jsx(_components.mi, {\n                      children: \"r\"\n                    }), _jsx(_components.mi, {\n                      children: \"e\"\n                    }), _jsx(_components.mi, {\n                      children: \"a\"\n                    }), _jsx(_components.mi, {\n                      children: \"d\"\n                    }), _jsx(_components.mi, {\n                      mathvariant: \"normal\",\n                      children: \"_\"\n                    }), _jsx(_components.mi, {\n                      children: \"r\"\n                    }), _jsx(_components.mi, {\n                      children: \"e\"\n                    }), _jsx(_components.mi, {\n                      children: \"q\"\n                    }), _jsx(_components.mi, {\n                      children: \"u\"\n                    }), _jsx(_components.mi, {\n                      children: \"e\"\n                    }), _jsx(_components.mi, {\n                      children: \"s\"\n                    }), _jsx(_components.mi, {\n                      children: \"t\"\n                    }), _jsx(_components.mi, {\n                      children: \"s\"\n                    })]\n                  })]\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                }), _jsx(_components.mo, {\n                  stretchy: \"false\",\n                  children: \")\"\n                })]\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"Hit\\\\text{\\\\textendash}Ratio=100 \\\\times (1 - (\\\\frac{innodb\\\\_pages\\\\_read}{innodb\\\\_buffer\\\\_pool\\\\_read\\\\_requests}))\"\n              })]\n            })\n          })\n        }), _jsxs(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: [_jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.08125em\"\n              },\n              children: \"H\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"i\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"t\"\n            }), _jsx(_components.span, {\n              className: \"mord text\",\n              children: _jsx(_components.span, {\n                className: \"mord\",\n                children: \"–\"\n              })\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.00773em\"\n              },\n              children: \"R\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"a\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"t\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"i\"\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"o\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mrel\",\n              children: \"=\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2778em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.7278em\",\n                verticalAlign: \"-0.0833em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"100\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"×\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"1em\",\n                verticalAlign: \"-0.25em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"1\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mbin\",\n              children: \"−\"\n            }), _jsx(_components.span, {\n              className: \"mspace\",\n              style: {\n                marginRight: \"0.2222em\"\n              }\n            })]\n          }), _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"2.3904em\",\n                verticalAlign: \"-0.996em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mopen\",\n              children: \"(\"\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mopen nulldelimiter\"\n              }), _jsx(_components.span, {\n                className: \"mfrac\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"1.3944em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-2.314em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"inn\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"o\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"d\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"b\"\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"_\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"b\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"u\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.10764em\"\n                            },\n                            children: \"f\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.10764em\"\n                            },\n                            children: \"f\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"er\"\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"_\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"p\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"oo\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.01968em\"\n                            },\n                            children: \"l\"\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"_\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"r\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"e\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"a\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"d\"\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"_\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"r\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"e\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.03588em\"\n                            },\n                            children: \"q\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"u\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"es\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"t\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"s\"\n                          })]\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.23em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"frac-line\",\n                          style: {\n                            borderBottomWidth: \"0.04em\"\n                          }\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3.7em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsxs(_components.span, {\n                          className: \"mord\",\n                          children: [_jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"inn\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"o\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"d\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"b\"\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"_\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"p\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"a\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.03588em\"\n                            },\n                            children: \"g\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"es\"\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"_\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            style: {\n                              marginRight: \"0.02778em\"\n                            },\n                            children: \"r\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"e\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"a\"\n                          }), _jsx(_components.span, {\n                            className: \"mord mathnormal\",\n                            children: \"d\"\n                          })]\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.996em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose nulldelimiter\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"mclose\",\n              children: \"))\"\n            })]\n          })]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If the hit ratio is not close to \", _jsx(_components.strong, {\n        children: \"100%\"\n      }), \" then increase the buffer pool size to allow the maximum DB data to fit but within memory requirements.\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      children: \"Query optimization\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Use \", _jsx(_components.strong, {\n        children: \"explain\"\n      }), \", \", _jsx(_components.strong, {\n        children: \"analyze\"\n      }), \", and \", _jsx(_components.strong, {\n        children: \"format\"\n      }), \"=\", \" to analyze the query breakdown steps, indexes used, and operations performed to get a hold on where we can improve the query processing by adding necessary indexes, dropping unnecessary conditions, re-ordering query steps, and other bottleneck steps.\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Check the query optimization plan\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Add indexes like composite index and covering index to completely cover all columns in the query for super fast lookup\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Re-write query as a \", _jsx(_components.strong, {\n          children: \"SARGABLE\"\n        }), \"(Search ARGument ABLE) query which utilizes the index for quick searching instead of working on each row\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Avoid functions and calculations on index columns in the query as these will apply for each row\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"For function-based where clause, create a function-based index on the column\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Limit the amount of data rows that need to be sorted by better query execution planning\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Rewrite JOINs into a subqueries sometimes gives better results\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Order of execution: FROM, JOIN, WHERE, GROUP BY, HAVING, SELECT, ORDER BY, LIMIT\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Indexes in MySQL\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Every table should have a primary key. If a primary key is not defined, then InnoDB uses the first unique non-null column as the primary key. If no such column exists, InnoDB creates a hidden row incremental key for the primary key.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Some of the trade-offs to consider are\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Sequential vs Non-sequential primary key\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Clustered vs Non-clustered index\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Single-level index vs Composite indexes (and Covering index)\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Single-level index vs Column order index\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If there are redundant indexes, then write operations takes time, check and remove the redundant indexes\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"select * from sys.schema_redundant_indexes;\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Also, check how much memory an index takes, and if it is not in acceptable levels, drop that index and change the schema for better performance.\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h2, {\n      children: \"Connection Pool\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"A DB connection comprises opening the tcp socket, acknowledgement, authentication, authorization, network session creation, etc. So, it takes time to open a new connection every time. So maintain a pool of connections to re-use.\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"By default, the \", _jsx(_components.em, {\n          children: \"max_open_connections\"\n        }), \" a MySQL server can handle is 150, but can be set up to 2^32 (but up to 100,000 should be the limit generally).\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Types of connection pooling:\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsx(_components.li, {\n            children: \"Session: Maintain connection until the session completes. The client can make any number of transactions until connection timeout is reached.\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"Transaction: Connection is returned to the pool when the transaction completes.\"\n          }), \"\\n\", _jsx(_components.li, {\n            children: \"Statement: A connection is used only for a single SQL statement.\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Generally, \", _jsx(_components.em, {\n          children: \"max_pool_size\"\n        }), \" (\", _jsx(_components.em, {\n          children: \"max_active_connections\"\n        }), \") is set to (2 or 4 * no.of cores), but it varies depending on the type of application and the traffic.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"For normal setup, \", _jsx(_components.em, {\n          children: \"max_idle_connections\"\n        }), \" (ex: 80) will be less than \", _jsx(_components.em, {\n          children: \"max_pool_size\"\n        }), \" (ex: 100, and 20 connections will be closed after use as the max idle connections are 80).\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"For high concurrent systems, set the \", _jsx(_components.em, {\n          children: \"max_idle_connections\"\n        }), \" the same as the \", _jsx(_components.em, {\n          children: \"max_pool_size\"\n        }), \", idle connections take some memory but it's a trade-off compared to the overhead of opening connections for highly frequent requests.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Scaling challenges\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Max open connections, idle connections, and pool size should be limited considering the system resources limit.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"System resources like memory, CPU cache, and data storage are required if there are more connections opened at a time. If the system can't handle more connections, all operations will be rejected and that leads to data inconsistency.\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"In Linux servers, the \", _jsx(_components.em, {\n          children: \"ulimit\"\n        }), \" restricts the max open file descriptors.\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"MySQL is multi-threaded and allocates one thread per connection which requires thread management overhead along with system resources.\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Configuration variables like \", _jsx(_components.em, {\n          children: \"thread_cache_size\"\n        }), \" (\", \" defaults to 8-100, and multiplexed to cores) which defines how many threads can be cached for re-use when the client disconnects. This also requires additional memory but improves performance.\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"MySQL creates a THD (Thread Handle Descriptor) for each connection with a minimum memory of ~10KB and can grow to ~10MB for average connection when executing queries. So, handling huge no.of parallel connections requires huge memory requirements and also high thrashing.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"As more no.of connections increases but the max_connections are set in limit which are nothing but user threads, there has to be a balance between the user thread-per-core ratio (max ratio recommended is ~4) and the latency. So, based on this, the transactions-per-second (TPS) the server can handle can be determined, and has to scale the DB for the expected load.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Another important challenge is the underlying disk storage. If there is huge data stored, the user threads spend most of the time for data to arrive from disk. So, better disk storage mechanism has to be considered like SSDs, cache, read/write heavy disks, etc.\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"In MySQL thread pool (enterprise edition), correctly tuning the \", _jsx(_components.em, {\n          children: \"thread_pool_size\"\n        }), \" and \", _jsx(_components.em, {\n          children: \"max_transaction_limit\"\n        }), \" for high concurrency is very difficult but it's better than the default thread handling mechanism.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Ref\"\n      }), \":\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"https://dev.mysql.com/blog-archive/mysql-connection-handling-and-scaling/\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://dev.mysql.com/blog-archive/the-new-mysql-thread-pool/\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://dev.to/dbvismarketing/a-guide-to-multithreading-in-sql-3hh1\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h2, {\n      children: \"Transactions Isolation\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In high concurrent transaction systems, it is important to isolate the transactions for data consistency. so, when multiple connections try to change the same data, how can transaction isolation be maintained so that the following problems can be avoided?\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Dirty Reads\"\n        }), \": A query in a transaction may return inconsistent data due to uncommitted changes in other transactions.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Non-repeatable Reads\"\n        }), \": The same query in a transaction reads different data rows if executed multiple times. This may happen due to other transactions committed to the changes.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Phantom Reads\"\n        }), \": The data rows returned by the select statements differ within the same transaction as another transaction might have inserted new rows.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The following isolation levels can be set in MySQL for transaction isolation:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Read Uncommitted\"\n        }), \": Transactions see other transactions' un-committed changes that may cause data inconsistencies. Suitable for highly frequent updates where accuracy/consistency is not critical. Ex: Dashboards, Analytics. Solves: None\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Read Committed\"\n        }), \": Transactions see other transactions changes only if they are committed. Consistent data but anything can happen between transactions. Suitable for both highly frequent and data-consistent scenarios. Ex: Banking, reservations. Solves: Dirty Reads.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Repeatable Read\"\n        }), \": A transaction sees the same snapshot of data throughout the life cycle and is unaffected by other transactions. Default in MySQL with InnoDB's MVCC(Multi-Version Concurrency Control). Suitable for data-consistent systems where performance can be compromised. Ex: General Web services. Solves Dirty Reads, Non-Repeatable Reads\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Serialization\"\n        }), \": Transactions lock the rows restricting other transactions to wait until completion. Suitable for high data consistent systems. Ex: Financial services. Solves: Dirty Reads, Non-repeatable Reads, Phantom Reads.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"So, based on the type of requirements, set the isolation level for high concurrent database transactions.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Ref\"\n      }), \":\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"https://planetscale.com/blog/mysql-isolation-levels-and-how-they-work\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://dev.to/eyo000000/a-straightforward-guide-for-mysql-locks-56i1\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://simon-ninon.medium.com/dont-break-production-learn-about-mysql-locks-297671ec8e73\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h2, {\n      children: \"MySQL Monitoring\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"MySQL can handle high concurrent traffic with a single instance if it is deployed with high CPU cores, fast access storage (SSD), and high RAM. Some of the variables to look out for monitoring are\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"max_connections\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"table_open_cache\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"threads_connected\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"threads_running\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"thread_cache_size\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_buffer_pool_size\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Also, monitor the status variables like\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Com_select, Com_insert, Com_update, Com_delete\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"status_queries\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"max_used_connections\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Check the reads and writes for a table with index used or not. Read count increases even without any operations also due to various reasons like background processes, cache eviction, etc., So these are not very accurate but give the proportion of operations that MySQL performs.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"select object_schema, object_name, count_read, count_write, index_name \\nfrom performance_schema.table_io_waits_summary_by_index_usage \\norder by count_read+count_write desc limit 5;\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Check the max percentage of concurrent connections at a time relative to max connections. If the value touches \u003e95%, then increase the max_connections value.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \"100 * threads_connected / max_connections\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Tune the following for better performance\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Increase the \", _jsx(_components.em, {\n          children: \"max_connections\"\n        }), \" and \", _jsx(_components.em, {\n          children: \"thread_cache_size\"\n        }), \" for handling high concurrent connections with reuse.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Increase the \", _jsx(_components.em, {\n          children: \"innodb_buffer_pool_size\"\n        }), \" for more cached data and less time for the server to read from the disk.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Monitor the \", _jsx(_components.strong, {\n          children: \"p99\"\n        }), \" which measures the latency of 99% of all transactions and check if that latency is within the defined limits.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.h3, {\n      children: \"MySQL configuration parameters\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Having discussed the various topics and internals of MySQL, the following are some of the important parameters that affect the MySQL performance. As the list is very large, I have just mentioned the names and they require separate discussion deeply.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"default-character-set = utf8mb4\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"max_connections\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"max_user_connections, max_allowed_packet, for limiting DDoS attacks\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_change_buffering\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_buffer_pool_size\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_buffer_pool_instances, if innodb_buffer_pool_size is more than 1GB set multiple instances\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_lru_scan_depth\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_io_capacity, innodb_io_capacity_max\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_max_dirty_pages_pct\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_flush_neighbors\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_read_io_threads, innodb_write_io_threads\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_flush_log_at_trx_commit, 1 is the default for ACID compliance. 0 or 2 for fast writes. For master keep it as 1.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_log_buffer_size\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_log_file_size, innodb_log_files_in_group, increase these for write-heavy, for read-heavy these are not important\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_flush_method, for SSD set value as O_DIRECT\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_adaptive_flushing\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_stats_on_metadata\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_doublewrite\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_purge_threads\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_thread_concurrency\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"innodb_parallel_read_threads\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"thread_cache_size\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"have_query_cache, disable for read-heavy production\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"wait_timeout, interactive_timeout\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"sort_buffer_size, read_rnd_buffer_size, join_buffer_size\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"performance_schema, disable if not needed\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"max_prepared_stmt_count, restrict to limit memory leaks\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"tmp_table_size, max_heap_table_size\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"table_open_cache, should be higher than opened_tables\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"table_open_cache_instances, table_definition_cache\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"slow_query_log, log_query_time\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsx(_components.p, {\n      children: \"For better performance, monitor the following things continuously\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"QPS (queries per second) under load\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Max concurrent connections at peak\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Read/write ratio to enhance the performance by replicas/partitions\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Buffer pool hit ratio\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"No.of I/O operations under load\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"CPU load with I/O wait time\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"p99 or p95 latency\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Ref\"\n      }), \":\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"https://github.com/major/MySQLTuner-perl/blob/master/INTERNALS.md\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://www.percona.com/blog/mysql-101-parameters-to-tune-for-mysql-performance/\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://www.woktron.com/secure/knowledgebase/272/How-to-optimize-MySQL-performance.html\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://www.red-gate.com/simple-talk/databases/mysql/optimizing-my-cnf-for-mysql-performance/\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://releem.com/docs/mysql-performance-parameters\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://blog.searce.com/fewer-cpu-cores-will-blockyour-database-iops-in-gcp-b817b8cb8af2\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://blog.searce.com/how-max-prepared-stmt-count-bring-down-the-production-mysql-system-6ca28e577663\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"https://tanishiking24.hatenablog.com/entry/innodb-durability\"\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"id":"mysql-performance-optimization-techniques"},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"mysql-performance-optimization-techniques"},"buildId":"IVVkt6-z9PpDoTmC5If8f","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>